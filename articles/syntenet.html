<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="syntenet">
<title>Inference and Analysis of Synteny Networks • syntenet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.6/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.6/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inference and Analysis of Synteny Networks">
<meta property="og:description" content="syntenet">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-#0092ac"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">syntenet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/syntenet.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/almeidasilvaf/syntenet/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="syntenet_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="syntenet_files/d3-4.5.0/d3.min.js"></script><script src="syntenet_files/forceNetwork-binding-0.4/forceNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Inference and Analysis of Synteny Networks</h1>
                        <h4 data-toc-skip class="author">Fabricio
Almeida-Silva</h4>
            <address class="author_afil">
      VIB-UGent Center for Plant Systems Biology, Ghent,
BelgiumDepartment of Plant Biotechnology and Bioinformatics, Ghent
University, Ghent,
Belgium<br><h4 data-toc-skip class="author">Tao
Zhao</h4>
            <address class="author_afil">
      State Key Laboratory of Crop Stress Biology for Arid Areas/Shaanxi
Key Laboratory of Apple, College of Horticulture, Northwest A&amp;F
University, Yangling,
China<br><h4 data-toc-skip class="author">Kristian
K Ullrich</h4>
            <address class="author_afil">
      Department of Evolutionary Biology, Max Planck Institute For
Evolutionary Biology, Ploen,
Germany<br><h4 data-toc-skip class="author">Yves
Van de Peer</h4>
            <address class="author_afil">
      VIB-UGent Center for Plant Systems Biology, Ghent,
BelgiumDepartment of Plant Biotechnology and Bioinformatics, Ghent
University, Ghent, BelgiumCollege of Horticulture, Academy for Advanced
Interdisciplinary Studies, Nanjing Agricultural University, Nanjing,
ChinaCenter for Microbial Ecology and Genomics, Department of
Biochemistry, Genetics and Microbiology, University of Pretoria,
Pretoria, South Africa<br><small class="dont-index">Source: <a href="https://github.com/almeidasilvaf/syntenet/blob/HEAD/vignettes/syntenet.Rmd" class="external-link"><code>vignettes/syntenet.Rmd</code></a></small>
      <div class="d-none name"><code>syntenet.Rmd</code></div>
    </address>
</address>
</address>
</address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The analysis of synteny (i.e., conserved gene content and order in a
genomic segment across species) can help understand the trajectory of
duplicated genes through evolution. In particular, synteny analyses are
widely used to investigate the evolution of genes derived from
whole-genome duplication (WGD) events, as they can reveal genomic
rearrangements that happened following the duplication of all
chromosomes. However, synteny analysis are typically performed in a
pairwise manner, which can be difficult to explore and interpret when
comparing several species. To understand global patterns of synteny,
<span class="citation">Zhao and Schranz (2017)</span> proposed a
network-based approach to analyze synteny. In synteny networks, genes in
a given syntenic block are represented as nodes connected by an edge.
Synteny networks have been used to explore, among others, global synteny
patterns in mammalian and angiosperm genomes <span class="citation">(Zhao and Schranz 2019)</span>, the evolution of
MADS-box transcription factors <span class="citation">(Zhao et al.
2017)</span>, and infer a microsynteny-based phylogeny for angiosperms
<span class="citation">(Zhao et al. 2021)</span>. <em><a href="https://bioconductor.org/packages/3.15/syntenet" class="external-link">syntenet</a></em>
is a package that can be used to infer synteny networks from protein
sequences and perform downstream network analyses that include:</p>
<ul>
<li><p><strong>Network clustering</strong> using the Infomap
algorithm;</p></li>
<li><p><strong>Phylogenomic profiling</strong>, which consists in
identifying which species contain which clusters. This analysis can
reveal highly conserved synteny clusters and taxon-specific ones (e.g.,
family- and order-specific clusters);</p></li>
<li><p><strong>Microsynteny-based phylogeny reconstruction</strong> with
maximum likelihood, which can be achieved by inferring a phylogeny from
a binary matrix of phylogenomic profiles with IQ-TREE.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><em><a href="https://bioconductor.org/packages/3.15/syntenet" class="external-link">syntenet</a></em>
can be installed from Bioconductor with the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">'BiocManager'</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'BiocManager'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"syntenet"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package after installation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/almeidasilvaf/syntenet" class="external-link">syntenet</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-description">Data description<a class="anchor" aria-label="anchor" href="#data-description"></a>
</h2>
<p>For this vignette, we will use the proteomes and gene annotation of
the algae species <em>Ostreococcus lucimarinus</em> and <em>Ostreococcus
sp RCC809</em>, which were obtained from Pico-PLAZA 3.0 <span class="citation">(Vandepoele et al. 2013)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Protein sequences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">proteomes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">proteomes</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Olucimarinus</span></span>
<span><span class="co">#&gt; AAStringSet object of length 1901:</span></span>
<span><span class="co">#&gt;        width seq                                            names               </span></span>
<span><span class="co">#&gt;    [1]   911 MTTMADERASIARVSVVKYGAI...VQLYTYPGSTNDPNFLLKLA* OL01G00010</span></span>
<span><span class="co">#&gt;    [2]   789 MGGRRCFCSRSSPVGVGAPAPA...PPQCGADIEAGSEPPPDKCG* OL01G00020</span></span>
<span><span class="co">#&gt;    [3]   618 MTRAKDAIVVDDGNDDDDDDDD...RDASASLALALAFSSEESVV* OL01G00030</span></span>
<span><span class="co">#&gt;    [4]   547 MPTKAQCWVVSYARVRDGASRS...TGSVSARASIFGEQASFRKA* OL01G00040</span></span>
<span><span class="co">#&gt;    [5]   319 MFTASHTTSKVTLRARVATQPR...HNGMALWRETTPKDSLIPAL* OL01G00050</span></span>
<span><span class="co">#&gt;    ...   ... ...</span></span>
<span><span class="co">#&gt; [1897]   106 MAANDGETKLPEDGWIQPCFAC...RAIVDQVGGEHLKGSLMPIE* OL03G05910</span></span>
<span><span class="co">#&gt; [1898]    70 RMGIVKLATDGSVWVHSPIELD...QQWKDAYPGATLYACPGLKSK OL03G05920</span></span>
<span><span class="co">#&gt; [1899]   680 MDDAHDARWATTSARDGERARA...RSVGPSASDKILEALFPVAD* OL03G05930</span></span>
<span><span class="co">#&gt; [1900]   179 MRAVRERSKANLAARVKEEATR...ELERTRELFARARVRAYECI* OL03G05940</span></span>
<span><span class="co">#&gt; [1901]    83 MFVREARRAIPRFIKDPPQAFH...ESGDVRSVEGEVCGAVLVDE* OL03G05950</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OspRCC809</span></span>
<span><span class="co">#&gt; AAStringSet object of length 1433:</span></span>
<span><span class="co">#&gt;        width seq                                            names               </span></span>
<span><span class="co">#&gt;    [1]   274 MASTTGSAARRVFVDVEKTVNG...DVLSLGQGSLSGESSSSDEE* ORCC809_01G00010</span></span>
<span><span class="co">#&gt;    [2]   175 MDQMRAANAQRSYLLFFVLFFL...SRRLLGRLDSEHTDLHPSWR* ORCC809_01G00020</span></span>
<span><span class="co">#&gt;    [3]   403 MTAPRVRASRRATATAAATVTA...LTERDLRYMEPKATIEEWMG* ORCC809_01G00030</span></span>
<span><span class="co">#&gt;    [4]   217 MTIDADGDDTLAPHAPAHGEVS...LIRLRGVEKTPTVDPPPPPP* ORCC809_01G00040</span></span>
<span><span class="co">#&gt;    [5]  1691 RIEADEKSLLVFGKESPVRTAC...VRMGNNVVTSRYASSESEEDV ORCC809_01G00050</span></span>
<span><span class="co">#&gt;    ...   ... ...</span></span>
<span><span class="co">#&gt; [1429]   428 MVDANATTQTFVLEAEQELRVE...DLPSNVLLVGNLKWLGEDGK* ORCC809_03G02980</span></span>
<span><span class="co">#&gt; [1430]   378 MSVPRTTLRRIPLGNARDVLVT...ETLKAIDAVHAQCRDPCIAT* ORCC809_03G02990</span></span>
<span><span class="co">#&gt; [1431]  1156 MRATSAPSIVSFVARVACLFVA...CAFGTSLASFVVERARRLEN* ORCC809_03G03000</span></span>
<span><span class="co">#&gt; [1432]   541 MAITVFLTDHGRRASALTFLVV...GFGVGAVKFMLAPEMVKSLA* ORCC809_03G03010</span></span>
<span><span class="co">#&gt; [1433]   289 MSLSSLRSFSRSISSAPGGRSC...EPEEPEPEEPEPEEPEEPEP* ORCC809_03G03020</span></span>
<span></span>
<span><span class="co"># Annotation (ranges)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">annotation</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRangesList object of length 2:</span></span>
<span><span class="co">#&gt; $Olucimarinus</span></span>
<span><span class="co">#&gt; GRanges object with 1903 ranges and 4 metadata columns:</span></span>
<span><span class="co">#&gt;          seqnames        ranges strand |     type          ID        Name</span></span>
<span><span class="co">#&gt;             &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;factor&gt; &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt;      [1]    Chr_1      939-3671      - |     gene  OL01G00010  OL01G00010</span></span>
<span><span class="co">#&gt;      [2]    Chr_1     3907-6927      + |     gene  OL01G00020  OL01G00020</span></span>
<span><span class="co">#&gt;      [3]    Chr_1     7085-9160      + |     gene  OL01G00030  OL01G00030</span></span>
<span><span class="co">#&gt;      [4]    Chr_1    9830-11480      + |     gene  OL01G00040  OL01G00040</span></span>
<span><span class="co">#&gt;      [5]    Chr_1   11467-12599      - |     gene  OL01G00050  OL01G00050</span></span>
<span><span class="co">#&gt;      ...      ...           ...    ... .      ...         ...         ...</span></span>
<span><span class="co">#&gt;   [1899]    Chr_3 977435-977752      - |     gene  OL03G05910  OL03G05910</span></span>
<span><span class="co">#&gt;   [1900]    Chr_3 978702-978911      - |     gene  OL03G05920  OL03G05920</span></span>
<span><span class="co">#&gt;   [1901]    Chr_3 979281-981320      - |     gene  OL03G05930  OL03G05930</span></span>
<span><span class="co">#&gt;   [1902]    Chr_3 981778-982314      + |     gene  OL03G05940  OL03G05940</span></span>
<span><span class="co">#&gt;   [1903]    Chr_3 982498-982746      + |     gene  OL03G05950  OL03G05950</span></span>
<span><span class="co">#&gt;              gene_id</span></span>
<span><span class="co">#&gt;          &lt;character&gt;</span></span>
<span><span class="co">#&gt;      [1]  OL01G00010</span></span>
<span><span class="co">#&gt;      [2]  OL01G00020</span></span>
<span><span class="co">#&gt;      [3]  OL01G00030</span></span>
<span><span class="co">#&gt;      [4]  OL01G00040</span></span>
<span><span class="co">#&gt;      [5]  OL01G00050</span></span>
<span><span class="co">#&gt;      ...         ...</span></span>
<span><span class="co">#&gt;   [1899]  OL03G05910</span></span>
<span><span class="co">#&gt;   [1900]  OL03G05920</span></span>
<span><span class="co">#&gt;   [1901]  OL03G05930</span></span>
<span><span class="co">#&gt;   [1902]  OL03G05940</span></span>
<span><span class="co">#&gt;   [1903]  OL03G05950</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 6 sequences from an unspecified genome; no seqlengths</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OspRCC809</span></span>
<span><span class="co">#&gt; GRanges object with 1433 ranges and 4 metadata columns:</span></span>
<span><span class="co">#&gt;          seqnames        ranges strand |     type               ID</span></span>
<span><span class="co">#&gt;             &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;factor&gt;      &lt;character&gt;</span></span>
<span><span class="co">#&gt;      [1]    chr_1      321-1142      - |     gene ORCC809_01G00010</span></span>
<span><span class="co">#&gt;      [2]    chr_1     1463-2089      + |     gene ORCC809_01G00020</span></span>
<span><span class="co">#&gt;      [3]    chr_1     2162-3370      - |     gene ORCC809_01G00030</span></span>
<span><span class="co">#&gt;      [4]    chr_1     3774-4424      - |     gene ORCC809_01G00040</span></span>
<span><span class="co">#&gt;      [5]    chr_1     4693-9924      - |     gene ORCC809_01G00050</span></span>
<span><span class="co">#&gt;      ...      ...           ...    ... .      ...              ...</span></span>
<span><span class="co">#&gt;   [1429]    chr_3 504915-506198      - |     gene ORCC809_03G02980</span></span>
<span><span class="co">#&gt;   [1430]    chr_3 506377-507510      + |     gene ORCC809_03G02990</span></span>
<span><span class="co">#&gt;   [1431]    chr_3 507856-511323      + |     gene ORCC809_03G03000</span></span>
<span><span class="co">#&gt;   [1432]    chr_3 511533-513155      - |     gene ORCC809_03G03010</span></span>
<span><span class="co">#&gt;   [1433]    chr_3 513841-514707      + |     gene ORCC809_03G03020</span></span>
<span><span class="co">#&gt;                      Name          gene_id</span></span>
<span><span class="co">#&gt;               &lt;character&gt;      &lt;character&gt;</span></span>
<span><span class="co">#&gt;      [1] ORCC809_01G00010 ORCC809_01G00010</span></span>
<span><span class="co">#&gt;      [2] ORCC809_01G00020 ORCC809_01G00020</span></span>
<span><span class="co">#&gt;      [3] ORCC809_01G00030 ORCC809_01G00030</span></span>
<span><span class="co">#&gt;      [4] ORCC809_01G00040 ORCC809_01G00040</span></span>
<span><span class="co">#&gt;      [5] ORCC809_01G00050 ORCC809_01G00050</span></span>
<span><span class="co">#&gt;      ...              ...              ...</span></span>
<span><span class="co">#&gt;   [1429] ORCC809_03G02980 ORCC809_03G02980</span></span>
<span><span class="co">#&gt;   [1430] ORCC809_03G02990 ORCC809_03G02990</span></span>
<span><span class="co">#&gt;   [1431] ORCC809_03G03000 ORCC809_03G03000</span></span>
<span><span class="co">#&gt;   [1432] ORCC809_03G03010 ORCC809_03G03010</span></span>
<span><span class="co">#&gt;   [1433] ORCC809_03G03020 ORCC809_03G03020</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 6 sequences from an unspecified genome; no seqlengths</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="importing-data-to-the-r-session">Importing data to the R session<a class="anchor" aria-label="anchor" href="#importing-data-to-the-r-session"></a>
</h2>
<p>To detect synteny and infer synteny networks, <em><a href="https://bioconductor.org/packages/3.15/syntenet" class="external-link">syntenet</a></em>
requires two objects as input:</p>
<ul>
<li>
<strong>seq:</strong> A list of <code>AAStringSet</code> objects
containing the translated sequences of primary transcripts for each
species.</li>
<li>
<strong>annotation:</strong> A <code>GRangesList</code> or
<code>CompressedGRangesList</code> object containing the coordinates for
the genes in <strong>seq</strong>.</li>
</ul>
<p>If you have whole-genome protein sequences in FASTA files, store all
FASTA files in the same directory and use the function
<code><a href="../reference/fasta2AAStringSetlist.html">fasta2AAStringSetlist()</a></code> to read all FASTA files into a list
of <code>AAStringSet</code> objects.</p>
<p>Likewise, if you have gene annotation in GFF/GFF3/GTF files, store
all files in the same directory and use the function
<code><a href="../reference/gff2GRangesList.html">gff2GRangesList()</a></code> to read all GFF/GFF3/GTF files into a
<code>GRangesList object</code>.</p>
<p>For a demonstration, we will read example FASTA and GFF3 files stored
in subdirectories named <strong>sequences/</strong> and
<strong>annotation/</strong>, which are located in the
<code>extdata/</code> directory of this package.</p>
<div class="section level3">
<h3 id="from-fasta-files-to-a-list-of-aastringset-objects">From FASTA files to a list of <code>AAStringSet</code> objects<a class="anchor" aria-label="anchor" href="#from-fasta-files-to-a-list-of-aastringset-objects"></a>
</h3>
<p>Here is how you can use <code><a href="../reference/fasta2AAStringSetlist.html">fasta2AAStringSetlist()</a></code> to read
FASTA files in a directory as a list of <code>AAStringSet</code>
objects.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Path to directory containing FASTA files</span></span>
<span><span class="va">fasta_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sequences"</span>, package <span class="op">=</span> <span class="st">"syntenet"</span><span class="op">)</span></span>
<span><span class="va">fasta_dir</span></span>
<span><span class="co">#&gt; [1] "/__w/_temp/Library/syntenet/extdata/sequences"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">fasta_dir</span><span class="op">)</span> <span class="co"># see the contents of the directory</span></span>
<span><span class="co">#&gt; [1] "Olucimarinus.fa.gz" "OspRCC809.fa.gz"</span></span>
<span></span>
<span><span class="co"># Read all FASTA files in `fasta_dir`</span></span>
<span><span class="va">aastringsetlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fasta2AAStringSetlist.html">fasta2AAStringSetlist</a></span><span class="op">(</span><span class="va">fasta_dir</span><span class="op">)</span></span>
<span><span class="va">aastringsetlist</span></span>
<span><span class="co">#&gt; $Olucimarinus</span></span>
<span><span class="co">#&gt; AAStringSet object of length 100:</span></span>
<span><span class="co">#&gt;       width seq                                             names               </span></span>
<span><span class="co">#&gt;   [1]   911 MTTMADERASIARVSVVKYGAI...DVQLYTYPGSTNDPNFLLKLA* OL01G00010</span></span>
<span><span class="co">#&gt;   [2]   789 MGGRRCFCSRSSPVGVGAPAPA...FPPQCGADIEAGSEPPPDKCG* OL01G00020</span></span>
<span><span class="co">#&gt;   [3]   618 MTRAKDAIVVDDGNDDDDDDDD...DRDASASLALALAFSSEESVV* OL01G00030</span></span>
<span><span class="co">#&gt;   [4]   547 MPTKAQCWVVSYARVRDGASRS...VTGSVSARASIFGEQASFRKA* OL01G00040</span></span>
<span><span class="co">#&gt;   [5]   319 MFTASHTTSKVTLRARVATQPR...LHNGMALWRETTPKDSLIPAL* OL01G00050</span></span>
<span><span class="co">#&gt;   ...   ... ...</span></span>
<span><span class="co">#&gt;  [96]   476 MVPARNFLDGANAREVELDRVV...VMRKLREPDSVARLAGQTGVR* OL01G00960</span></span>
<span><span class="co">#&gt;  [97]   771 MARHRGTRGGWNATTTEGGDGR...SIPDDGFDESSSVSASTIDGF* OL01G00970</span></span>
<span><span class="co">#&gt;  [98]   494 MDSEFWGCVIPAGRAVRVEVAT...FIKSRKDLFTIDGAYVRLVKK* OL01G00980</span></span>
<span><span class="co">#&gt;  [99]   264 VRAIVGATTRIQTRAPPRANHR...DWSFISDEFQDDASDSEVIDR* OL01G00990</span></span>
<span><span class="co">#&gt; [100]   565 MQLDAFRKATVKGVATRVGGAD...QLADLLRKNMGVPAKFIDAQN* OL01G01000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OspRCC809</span></span>
<span><span class="co">#&gt; AAStringSet object of length 100:</span></span>
<span><span class="co">#&gt;       width seq                                             names               </span></span>
<span><span class="co">#&gt;   [1]   274 MASTTGSAARRVFVDVEKTVNG...WDVLSLGQGSLSGESSSSDEE* ORCC809_01G00010</span></span>
<span><span class="co">#&gt;   [2]   175 MDQMRAANAQRSYLLFFVLFFL...SSRRLLGRLDSEHTDLHPSWR* ORCC809_01G00020</span></span>
<span><span class="co">#&gt;   [3]   403 MTAPRVRASRRATATAAATVTA...ALTERDLRYMEPKATIEEWMG* ORCC809_01G00030</span></span>
<span><span class="co">#&gt;   [4]   217 MTIDADGDDTLAPHAPAHGEVS...SLIRLRGVEKTPTVDPPPPPP* ORCC809_01G00040</span></span>
<span><span class="co">#&gt;   [5]  1691 RIEADEKSLLVFGKESPVRTAC...SVRMGNNVVTSRYASSESEEDV ORCC809_01G00050</span></span>
<span><span class="co">#&gt;   ...   ... ...</span></span>
<span><span class="co">#&gt;  [96]   357 MSRGLADNWDDAEGYYCARIGE...TVNEALQHPFIVERIRTTAPN* ORCC809_01G00960</span></span>
<span><span class="co">#&gt;  [97]   164 MAMDSFRSAPRSRRRVEATSRE...SKPVKPVREPVRMVEASTGAH* ORCC809_01G00970</span></span>
<span><span class="co">#&gt;  [98]    85 MPEGTVFIGNIPYDATESSLTE...NLNAREYNGRQLRVDHAETMKG ORCC809_01G00980</span></span>
<span><span class="co">#&gt;  [99]   229 MKGGGGASGAAASANGNGAVGG...PDQRAQVEYLRQLAAQQGMVR* ORCC809_01G00990</span></span>
<span><span class="co">#&gt; [100]   103 RKAGGERWEDSSLAEWPENDFR...EMAGKFIGNRPVKLRKSAWNER ORCC809_01G01000</span></span></code></pre></div>
<p>And that’s it! Now you have a list of <code>AAStringSet</code>
objects.</p>
</div>
<div class="section level3">
<h3 id="from-gffgtf-files-to-a-grangeslist-object">From GFF/GTF files to a <code>GRangesList</code> object<a class="anchor" aria-label="anchor" href="#from-gffgtf-files-to-a-grangeslist-object"></a>
</h3>
<p>Here is how you can use <code><a href="../reference/gff2GRangesList.html">gff2GRangesList()</a></code> to read
GFF/GFF3/GTF files in a directory as a <code>GRangesList</code>
object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Path to directory containing FASTA files</span></span>
<span><span class="va">gff_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"annotation"</span>, package <span class="op">=</span> <span class="st">"syntenet"</span><span class="op">)</span></span>
<span><span class="va">gff_dir</span></span>
<span><span class="co">#&gt; [1] "/__w/_temp/Library/syntenet/extdata/annotation"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">gff_dir</span><span class="op">)</span> <span class="co"># see the contents of the directory</span></span>
<span><span class="co">#&gt; [1] "Olucimarinus.gff3.gz" "OspRCC809.gff3.gz"</span></span>
<span></span>
<span><span class="co"># Read all FASTA files in `fasta_dir`</span></span>
<span><span class="va">grangeslist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gff2GRangesList.html">gff2GRangesList</a></span><span class="op">(</span><span class="va">gff_dir</span><span class="op">)</span></span>
<span><span class="va">grangeslist</span></span>
<span><span class="co">#&gt; GRangesList object of length 2:</span></span>
<span><span class="co">#&gt; $Olucimarinus</span></span>
<span><span class="co">#&gt; GRanges object with 100 ranges and 7 metadata columns:</span></span>
<span><span class="co">#&gt;         seqnames        ranges strand |      source     type     score</span></span>
<span><span class="co">#&gt;            &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;factor&gt; &lt;factor&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;     [1]    Chr_1      939-3671      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [2]    Chr_1     3907-6927      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [3]    Chr_1     7085-9160      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [4]    Chr_1    9830-11480      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [5]    Chr_1   11467-12599      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     ...      ...           ...    ... .         ...      ...       ...</span></span>
<span><span class="co">#&gt;    [96]    Chr_1 170975-172402      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;    [97]    Chr_1 172445-174757      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;    [98]    Chr_1 175358-176839      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;    [99]    Chr_1 176901-177692      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;   [100]    Chr_1 177742-179436      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;             phase          ID        Name     gene_id</span></span>
<span><span class="co">#&gt;         &lt;integer&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt;     [1]      &lt;NA&gt;  OL01G00010  OL01G00010  OL01G00010</span></span>
<span><span class="co">#&gt;     [2]      &lt;NA&gt;  OL01G00020  OL01G00020  OL01G00020</span></span>
<span><span class="co">#&gt;     [3]      &lt;NA&gt;  OL01G00030  OL01G00030  OL01G00030</span></span>
<span><span class="co">#&gt;     [4]      &lt;NA&gt;  OL01G00040  OL01G00040  OL01G00040</span></span>
<span><span class="co">#&gt;     [5]      &lt;NA&gt;  OL01G00050  OL01G00050  OL01G00050</span></span>
<span><span class="co">#&gt;     ...       ...         ...         ...         ...</span></span>
<span><span class="co">#&gt;    [96]      &lt;NA&gt;  OL01G00960  OL01G00960  OL01G00960</span></span>
<span><span class="co">#&gt;    [97]      &lt;NA&gt;  OL01G00970  OL01G00970  OL01G00970</span></span>
<span><span class="co">#&gt;    [98]      &lt;NA&gt;  OL01G00980  OL01G00980  OL01G00980</span></span>
<span><span class="co">#&gt;    [99]      &lt;NA&gt;  OL01G00990  OL01G00990  OL01G00990</span></span>
<span><span class="co">#&gt;   [100]      &lt;NA&gt;  OL01G01000  OL01G01000  OL01G01000</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OspRCC809</span></span>
<span><span class="co">#&gt; GRanges object with 100 ranges and 7 metadata columns:</span></span>
<span><span class="co">#&gt;         seqnames        ranges strand |      source     type     score</span></span>
<span><span class="co">#&gt;            &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;factor&gt; &lt;factor&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;     [1]    chr_1      321-1142      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [2]    chr_1     1463-2089      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [3]    chr_1     2162-3370      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [4]    chr_1     3774-4424      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     [5]    chr_1     4693-9924      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;     ...      ...           ...    ... .         ...      ...       ...</span></span>
<span><span class="co">#&gt;    [96]    chr_1 165459-166529      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;    [97]    chr_1 166654-167213      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;    [98]    chr_1 167296-167550      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;    [99]    chr_1 167542-168228      + | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;   [100]    chr_1 168639-168947      - | rtracklayer     gene        NA</span></span>
<span><span class="co">#&gt;             phase               ID             Name          gene_id</span></span>
<span><span class="co">#&gt;         &lt;integer&gt;      &lt;character&gt;      &lt;character&gt;      &lt;character&gt;</span></span>
<span><span class="co">#&gt;     [1]      &lt;NA&gt; ORCC809_01G00010 ORCC809_01G00010 ORCC809_01G00010</span></span>
<span><span class="co">#&gt;     [2]      &lt;NA&gt; ORCC809_01G00020 ORCC809_01G00020 ORCC809_01G00020</span></span>
<span><span class="co">#&gt;     [3]      &lt;NA&gt; ORCC809_01G00030 ORCC809_01G00030 ORCC809_01G00030</span></span>
<span><span class="co">#&gt;     [4]      &lt;NA&gt; ORCC809_01G00040 ORCC809_01G00040 ORCC809_01G00040</span></span>
<span><span class="co">#&gt;     [5]      &lt;NA&gt; ORCC809_01G00050 ORCC809_01G00050 ORCC809_01G00050</span></span>
<span><span class="co">#&gt;     ...       ...              ...              ...              ...</span></span>
<span><span class="co">#&gt;    [96]      &lt;NA&gt; ORCC809_01G00960 ORCC809_01G00960 ORCC809_01G00960</span></span>
<span><span class="co">#&gt;    [97]      &lt;NA&gt; ORCC809_01G00970 ORCC809_01G00970 ORCC809_01G00970</span></span>
<span><span class="co">#&gt;    [98]      &lt;NA&gt; ORCC809_01G00980 ORCC809_01G00980 ORCC809_01G00980</span></span>
<span><span class="co">#&gt;    [99]      &lt;NA&gt; ORCC809_01G00990 ORCC809_01G00990 ORCC809_01G00990</span></span>
<span><span class="co">#&gt;   [100]      &lt;NA&gt; ORCC809_01G01000 ORCC809_01G01000 ORCC809_01G01000</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre></div>
<p>And now you have a <code>GRangesList</code> object.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-preprocessing">Data preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h2>
<p>The first part of the pipeline consists in processing the data to
make it match a standard structure. However, before processing the data
for synteny detection, you must use the function
<code><a href="../reference/check_input.html">check_input()</a></code> to check if your data can enter the pipeline.
This function checks the input data for 3 required conditions:</p>
<ol style="list-style-type: decimal">
<li><p>Names of <strong>seq</strong> list (i.e.,
<code>names(seq)</code>) match the names of <strong>annotation</strong>
<code>GRangesList</code>/<code>CompressedGRangesList</code> (i.e.,
<code>names(annotation)</code>)</p></li>
<li><p>For each species (list elements), the number of sequences in
<strong>seq</strong> is not greater than the number of genes in
<strong>annotation</strong>. This is a way to ensure users do not input
the translated sequences for multiple isoforms of the same gene
(generated by alternative splicing). Ideally, the number of sequences in
<strong>seq</strong> should be equal to the number of genes in
<strong>annotation</strong>, but this may not always stand true because
of non-protein-coding genes.</p></li>
<li><p>For each species, sequence names (i.e.,
<code>names(seq[[x]])</code>, equivalent to FASTA headers) match gene
names in <code>annotation</code>. By default, <em><a href="https://bioconductor.org/packages/3.15/syntenet" class="external-link">syntenet</a></em>
looks for gene IDs in a column named “gene_id” in the GRanges objects
(default field in GFF3 files). If your gene IDs are in a different
column (e.g., “Name”), you can specify it in the <em>gene_field</em>
parameter of <code><a href="../reference/check_input.html">check_input()</a></code> and
<code><a href="../reference/process_input.html">process_input()</a></code>.</p></li>
</ol>
<p>Let’s check if the example data sets satisfy these 3 criteria:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_input.html">check_input</a></span><span class="op">(</span><span class="va">proteomes</span>, <span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>As you can see, the data passed the checks. Now, let’s process them
with the function <code><a href="../reference/process_input.html">process_input()</a></code>.</p>
<p>This function processes the input sequences and annotation to:</p>
<ol style="list-style-type: decimal">
<li><p>Remove whitespace and anything after it in sequence names (i.e.,
<code>names(seq[[x]])</code>, which is equivalent to FASTA headers), if
there is any.</p></li>
<li><p>Add a unique species identifier to sequence names. The species
identifier consists of the first 3-5 strings of the element name. For
instance, if the first element of the <strong>seq</strong> list is named
“Athaliana”, each sequence in it will have an identifier “Atha_” added
to the beginning of each gene name (e.g., Atha_AT1G01010).</p></li>
<li><p>If sequences have an asterisk (*) representing stop codon, remove
it.</p></li>
<li><p>Add a unique species identifier (same as above) to gene and
chromosome names of each element of the <strong>annotation</strong>
<code>GRangesList</code>/<code>CompressedGRangesList</code>.</p></li>
<li><p>Filter each element of the <strong>annotation</strong>
<code>GRangesList</code>/<code>CompressedGRangesList</code> to keep only
seqnames, ranges, and gene ID.</p></li>
</ol>
<p>Let’s process our input data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_input.html">process_input</a></span><span class="op">(</span><span class="va">proteomes</span>, <span class="va">annotation</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Looking at the processed data</span></span>
<span><span class="va">pdata</span><span class="op">$</span><span class="va">seq</span></span>
<span><span class="co">#&gt; $Olucimarinus</span></span>
<span><span class="co">#&gt; AAStringSet object of length 1901:</span></span>
<span><span class="co">#&gt;        width seq                                            names               </span></span>
<span><span class="co">#&gt;    [1]   910 MTTMADERASIARVSVVKYGAI...DVQLYTYPGSTNDPNFLLKLA Olu_OL01G00010</span></span>
<span><span class="co">#&gt;    [2]   788 MGGRRCFCSRSSPVGVGAPAPA...FPPQCGADIEAGSEPPPDKCG Olu_OL01G00020</span></span>
<span><span class="co">#&gt;    [3]   617 MTRAKDAIVVDDGNDDDDDDDD...DRDASASLALALAFSSEESVV Olu_OL01G00030</span></span>
<span><span class="co">#&gt;    [4]   546 MPTKAQCWVVSYARVRDGASRS...VTGSVSARASIFGEQASFRKA Olu_OL01G00040</span></span>
<span><span class="co">#&gt;    [5]   318 MFTASHTTSKVTLRARVATQPR...LHNGMALWRETTPKDSLIPAL Olu_OL01G00050</span></span>
<span><span class="co">#&gt;    ...   ... ...</span></span>
<span><span class="co">#&gt; [1897]   105 MAANDGETKLPEDGWIQPCFAC...LRAIVDQVGGEHLKGSLMPIE Olu_OL03G05910</span></span>
<span><span class="co">#&gt; [1898]    69 RMGIVKLATDGSVWVHSPIELD...AQQWKDAYPGATLYACPGLKS Olu_OL03G05920</span></span>
<span><span class="co">#&gt; [1899]   679 MDDAHDARWATTSARDGERARA...ARSVGPSASDKILEALFPVAD Olu_OL03G05930</span></span>
<span><span class="co">#&gt; [1900]   178 MRAVRERSKANLAARVKEEATR...LELERTRELFARARVRAYECI Olu_OL03G05940</span></span>
<span><span class="co">#&gt; [1901]    82 MFVREARRAIPRFIKDPPQAFH...QESGDVRSVEGEVCGAVLVDE Olu_OL03G05950</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OspRCC809</span></span>
<span><span class="co">#&gt; AAStringSet object of length 1433:</span></span>
<span><span class="co">#&gt;        width seq                                            names               </span></span>
<span><span class="co">#&gt;    [1]   273 MASTTGSAARRVFVDVEKTVNG...WDVLSLGQGSLSGESSSSDEE Osp_ORCC809_01G00010</span></span>
<span><span class="co">#&gt;    [2]   174 MDQMRAANAQRSYLLFFVLFFL...SSRRLLGRLDSEHTDLHPSWR Osp_ORCC809_01G00020</span></span>
<span><span class="co">#&gt;    [3]   402 MTAPRVRASRRATATAAATVTA...ALTERDLRYMEPKATIEEWMG Osp_ORCC809_01G00030</span></span>
<span><span class="co">#&gt;    [4]   216 MTIDADGDDTLAPHAPAHGEVS...SLIRLRGVEKTPTVDPPPPPP Osp_ORCC809_01G00040</span></span>
<span><span class="co">#&gt;    [5]  1690 RIEADEKSLLVFGKESPVRTAC...SVRMGNNVVTSRYASSESEED Osp_ORCC809_01G00050</span></span>
<span><span class="co">#&gt;    ...   ... ...</span></span>
<span><span class="co">#&gt; [1429]   427 MVDANATTQTFVLEAEQELRVE...GDLPSNVLLVGNLKWLGEDGK Osp_ORCC809_03G02980</span></span>
<span><span class="co">#&gt; [1430]   377 MSVPRTTLRRIPLGNARDVLVT...KETLKAIDAVHAQCRDPCIAT Osp_ORCC809_03G02990</span></span>
<span><span class="co">#&gt; [1431]  1155 MRATSAPSIVSFVARVACLFVA...ACAFGTSLASFVVERARRLEN Osp_ORCC809_03G03000</span></span>
<span><span class="co">#&gt; [1432]   540 MAITVFLTDHGRRASALTFLVV...PGFGVGAVKFMLAPEMVKSLA Osp_ORCC809_03G03010</span></span>
<span><span class="co">#&gt; [1433]   288 MSLSSLRSFSRSISSAPGGRSC...EEPEEPEPEEPEPEEPEEPEP Osp_ORCC809_03G03020</span></span>
<span><span class="va">pdata</span><span class="op">$</span><span class="va">annotation</span></span>
<span><span class="co">#&gt; $Olucimarinus</span></span>
<span><span class="co">#&gt; GRanges object with 1903 ranges and 1 metadata column:</span></span>
<span><span class="co">#&gt;           seqnames        ranges strand |           gene</span></span>
<span><span class="co">#&gt;              &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;character&gt;</span></span>
<span><span class="co">#&gt;      [1] Olu_Chr_1      939-3671      - | Olu_OL01G00010</span></span>
<span><span class="co">#&gt;      [2] Olu_Chr_1     3907-6927      + | Olu_OL01G00020</span></span>
<span><span class="co">#&gt;      [3] Olu_Chr_1     7085-9160      + | Olu_OL01G00030</span></span>
<span><span class="co">#&gt;      [4] Olu_Chr_1    9830-11480      + | Olu_OL01G00040</span></span>
<span><span class="co">#&gt;      [5] Olu_Chr_1   11467-12599      - | Olu_OL01G00050</span></span>
<span><span class="co">#&gt;      ...       ...           ...    ... .            ...</span></span>
<span><span class="co">#&gt;   [1899] Olu_Chr_3 977435-977752      - | Olu_OL03G05910</span></span>
<span><span class="co">#&gt;   [1900] Olu_Chr_3 978702-978911      - | Olu_OL03G05920</span></span>
<span><span class="co">#&gt;   [1901] Olu_Chr_3 979281-981320      - | Olu_OL03G05930</span></span>
<span><span class="co">#&gt;   [1902] Olu_Chr_3 981778-982314      + | Olu_OL03G05940</span></span>
<span><span class="co">#&gt;   [1903] Olu_Chr_3 982498-982746      + | Olu_OL03G05950</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 3 sequences from an unspecified genome; no seqlengths</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OspRCC809</span></span>
<span><span class="co">#&gt; GRanges object with 1433 ranges and 1 metadata column:</span></span>
<span><span class="co">#&gt;           seqnames        ranges strand |                 gene</span></span>
<span><span class="co">#&gt;              &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |          &lt;character&gt;</span></span>
<span><span class="co">#&gt;      [1] Osp_chr_1      321-1142      - | Osp_ORCC809_01G00010</span></span>
<span><span class="co">#&gt;      [2] Osp_chr_1     1463-2089      + | Osp_ORCC809_01G00020</span></span>
<span><span class="co">#&gt;      [3] Osp_chr_1     2162-3370      - | Osp_ORCC809_01G00030</span></span>
<span><span class="co">#&gt;      [4] Osp_chr_1     3774-4424      - | Osp_ORCC809_01G00040</span></span>
<span><span class="co">#&gt;      [5] Osp_chr_1     4693-9924      - | Osp_ORCC809_01G00050</span></span>
<span><span class="co">#&gt;      ...       ...           ...    ... .                  ...</span></span>
<span><span class="co">#&gt;   [1429] Osp_chr_3 504915-506198      - | Osp_ORCC809_03G02980</span></span>
<span><span class="co">#&gt;   [1430] Osp_chr_3 506377-507510      + | Osp_ORCC809_03G02990</span></span>
<span><span class="co">#&gt;   [1431] Osp_chr_3 507856-511323      + | Osp_ORCC809_03G03000</span></span>
<span><span class="co">#&gt;   [1432] Osp_chr_3 511533-513155      - | Osp_ORCC809_03G03010</span></span>
<span><span class="co">#&gt;   [1433] Osp_chr_3 513841-514707      + | Osp_ORCC809_03G03020</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 3 sequences from an unspecified genome; no seqlengths</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="synteny-network-inference">Synteny network inference<a class="anchor" aria-label="anchor" href="#synteny-network-inference"></a>
</h2>
<p>Now that we have our processed data, we can infer the synteny
network. To detect synteny, we need the tabular output from BLASTp <span class="citation">(Altschul et al. 1997)</span> or similar programs. To
get that, you can use the function <code><a href="../reference/run_diamond.html">run_diamond()</a></code>, which
runs DIAMOND <span class="citation">(Buchfink, Reuter, and Drost
2021)</span> from the R session and automatically parses its output to a
list of data frames <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Alternative:&lt;/strong&gt; if you want to use a
different program for similarity searches, you can run it on the command
line, save the output in a DIAMOND/BLAST-like tabular format, and read
the output files as a list of data frames with the function
&lt;code&gt;&lt;a href="../reference/read_diamond.html"&gt;read_diamond()&lt;/a&gt;&lt;/code&gt; (see the FAQ for details).&lt;/p&gt;'><sup>1</sup></a>.</p>
<p>Let’s demonstrate how <code><a href="../reference/run_diamond.html">run_diamond()</a></code> works. Needless to
say, you need to have DIAMOND installed in your machine and in your PATH
to run this function. To check if you have DIAMOND installed, use the
function <code><a href="../reference/diamond_is_installed.html">diamond_is_installed()</a></code> <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; in the code chunk below, the if
statement is not required. We just added it to make sure that the
function &lt;code&gt;&lt;a href="../reference/run_diamond.html"&gt;run_diamond()&lt;/a&gt;&lt;/code&gt; is only executed if DIAMOND is
installed, to avoid problems when building this vignette in machines
that do not have DIAMOND installed. If you want to reproduce the code in
this vignette and do not have DIAMOND installed, you can use the example
output of &lt;code&gt;&lt;a href="../reference/run_diamond.html"&gt;run_diamond()&lt;/a&gt;&lt;/code&gt; stored in the &lt;em&gt;blast_list&lt;/em&gt;
object (loaded with &lt;code&gt;data(blast_list)&lt;/code&gt;).&lt;/p&gt;'><sup>2</sup></a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">blast_list</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="../reference/diamond_is_installed.html">diamond_is_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">blast_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_diamond.html">run_diamond</a></span><span class="op">(</span>seq <span class="op">=</span> <span class="va">pdata</span><span class="op">$</span><span class="va">seq</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The output of <code><a href="../reference/run_diamond.html">run_diamond()</a></code> is a list of data frames
containing the tabular output of all-vs-all DIAMOND searches. Let’s take
a look at it.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">blast_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Olucimarinus_Olucimarinus" "Olucimarinus_OspRCC809"   </span></span>
<span><span class="co">#&gt; [3] "OspRCC809_Olucimarinus"    "OspRCC809_OspRCC809"</span></span>
<span></span>
<span><span class="co"># Inspect first data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">blast_list</span><span class="op">$</span><span class="va">Olucimarinus_Olucimarinus</span><span class="op">)</span></span>
<span><span class="co">#&gt;            query             db perc_identity length mismatches gap_open qstart</span></span>
<span><span class="co">#&gt; 1 Olu_OL01G00010 Olu_OL01G00010         100.0    910          0        0      1</span></span>
<span><span class="co">#&gt; 2 Olu_OL01G00010 Olu_OL01G00020          30.0    494        310       10    427</span></span>
<span><span class="co">#&gt; 3 Olu_OL01G00020 Olu_OL01G00020         100.0    788          0        0      1</span></span>
<span><span class="co">#&gt; 4 Olu_OL01G00020 Olu_OL01G00010          28.7    614        370       17    155</span></span>
<span><span class="co">#&gt; 5 Olu_OL01G00030 Olu_OL01G00030         100.0    617          0        0      1</span></span>
<span><span class="co">#&gt; 6 Olu_OL01G00040 Olu_OL01G00040         100.0    546          0        0      1</span></span>
<span><span class="co">#&gt;   qend tstart tend   evalue bitscore</span></span>
<span><span class="co">#&gt; 1  910      1  910 0.00e+00     1623</span></span>
<span><span class="co">#&gt; 2  894    270  753 1.67e-54      199</span></span>
<span><span class="co">#&gt; 3  788      1  788 0.00e+00     1363</span></span>
<span><span class="co">#&gt; 4  753    334  894 3.98e-56      204</span></span>
<span><span class="co">#&gt; 5  617      1  617 0.00e+00     1046</span></span>
<span><span class="co">#&gt; 6  546      1  546 0.00e+00     1035</span></span></code></pre></div>
<p>Now, we can use this list of DIAMOND data frames to detect synteny.
Here, we reimplemented the popular MCScanX algorithm <span class="citation">(Y. Wang et al. 2012)</span>, originally written in
C++, using the <em><a href="https://CRAN.R-project.org/package=Rcpp" class="external-link">Rcpp</a></em> <span class="citation">(Eddelbuettel and François 2011)</span> framework for R
and C++ integration. This means that <em><a href="https://bioconductor.org/packages/3.15/syntenet" class="external-link">syntenet</a></em>
comes with a native version of the MCScanX algorithm, so you can run
MCScanX in R without having to install it yourself. Amazing, huh?</p>
<p>To detect synteny and infer the synteny network, use the function
<code><a href="../reference/infer_syntenet.html">infer_syntenet()</a></code>. The output is a network represented as a
so-called <strong>edge list</strong> (i.e., a 2-column data frame with
node 1 and node 2 in columns 1 and 2, respectively).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Infer synteny network</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/infer_syntenet.html">infer_syntenet</a></span><span class="op">(</span><span class="va">blast_list</span>, <span class="va">pdata</span><span class="op">$</span><span class="va">annotation</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Anchor1              Anchor2</span></span>
<span><span class="co">#&gt; 1 Olu_OL01G00070 Osp_ORCC809_01G06520</span></span>
<span><span class="co">#&gt; 2 Olu_OL01G00100 Osp_ORCC809_01G06480</span></span>
<span><span class="co">#&gt; 3 Olu_OL01G00130 Osp_ORCC809_01G06440</span></span>
<span><span class="co">#&gt; 4 Olu_OL01G00150 Osp_ORCC809_01G06420</span></span>
<span><span class="co">#&gt; 5 Olu_OL01G00160 Osp_ORCC809_01G06410</span></span>
<span><span class="co">#&gt; 6 Olu_OL01G00170 Osp_ORCC809_01G06400</span></span></code></pre></div>
<p>In a synteny network, each row of the edge list represents an anchor
pair. In the edge list above, for example, the genes Olu_OL01G00070 and
Osp_ORCC809_01G06520 are an anchor pair (i.e., duplicates derived from a
large-scale duplication event).</p>
<p>Note that gene IDs are preceded by IDs created with
<code><a href="../reference/process_input.html">process_input()</a></code>. Under the hood,
<code><a href="../reference/process_input.html">process_input()</a></code> uses the function
<code><a href="../reference/create_species_id_table.html">create_species_id_table()</a></code> to create unique IDs from the
names of the <strong>seq</strong> and <strong>annotation</strong> lists.
To obtain a data frame of all IDs and their corresponding species, you
can use the following code:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get a 2-column data frame of species IDs and names</span></span>
<span><span class="va">id_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_species_id_table.html">create_species_id_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">proteomes</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">id_table</span></span>
<span><span class="co">#&gt;   species_id species_name</span></span>
<span><span class="co">#&gt; 1        Olu Olucimarinus</span></span>
<span><span class="co">#&gt; 2        Osp    OspRCC809</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phylogenomic-profiling">Phylogenomic profiling<a class="anchor" aria-label="anchor" href="#phylogenomic-profiling"></a>
</h2>
<p>After inferring the synteny network, the first thing you would want
to do is cluster your network and identify which phylogenetic groups are
contained in each cluster. This is what we call <strong>phylogenomic
profiling</strong>. This way, you can identify clade-specific clusters,
and highly conserved clusters, for instance. Here, we will use an
example network of BUSCO genes for 25 eudicot species, which was
obtained from <span class="citation">Zhao and Schranz (2019)</span>.</p>
<p>To obtain the phylogenomic profiles, you first need to cluster your
network. This can be done with <code><a href="../reference/cluster_network.html">cluster_network()</a></code>. <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Friendly tip:&lt;/strong&gt; &lt;em&gt;&lt;a href="https://bioconductor.org/packages/3.15/syntenet" class="external-link"&gt;syntenet&lt;/a&gt;&lt;/em&gt;
uses the &lt;em&gt;Infomap&lt;/em&gt; algorithm to cluster networks, which has been
shown to have the best performance &lt;span class="citation"&gt;(Zhao and
Schranz 2019)&lt;/span&gt;. However, you can use any other network clustering
method implemented in the &lt;em&gt;cluster_&lt;/em&gt; family of functions from the
&lt;em&gt;&lt;a href="https://CRAN.R-project.org/package=igraph" class="external-link"&gt;igraph&lt;/a&gt;&lt;/em&gt;
package by passing the function directly to the &lt;em&gt;clust_function&lt;/em&gt;
parameter (see &lt;code&gt;&lt;a href="../reference/cluster_network.html"&gt;?cluster_network&lt;/a&gt;&lt;/code&gt; for details). Importantly,
the Infomap algorithm (default clustering method) assigns each gene to a
single cluster. However, for some cases (e.g., detection of tandem
arrays), you may want to use an algorithm that allows community overlap
(i.e., a gene can be part of more than one cluster). If this is your
case, we recommend the &lt;em&gt;clique percolation&lt;/em&gt; algorithm, which is
implemented in the R package &lt;em&gt;&lt;a href="https://CRAN.R-project.org/package=CliquePercolation" class="external-link"&gt;CliquePercolation&lt;/a&gt;&lt;/em&gt;
&lt;span class="citation"&gt;(Lange 2021)&lt;/span&gt;.&lt;/p&gt;'><sup>3</sup></a></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load example data and take a look at it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span></span>
<span><span class="co">#&gt;       node1           node2</span></span>
<span><span class="co">#&gt; 1 cca_23646  Lang_109327134</span></span>
<span><span class="co">#&gt; 2 cca_23646  Lang_109328075</span></span>
<span><span class="co">#&gt; 3 cca_23646   Mnot_21394516</span></span>
<span><span class="co">#&gt; 4 cca_23646  Zjuj_107413994</span></span>
<span><span class="co">#&gt; 5 cca_23646 adu_Aradu.8SN53</span></span>
<span><span class="co">#&gt; 6 cca_23646     car_14082.1</span></span>
<span></span>
<span><span class="co"># Cluster network</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster_network.html">cluster_network</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Gene Cluster</span></span>
<span><span class="co">#&gt; 1 cca_23646       1</span></span>
<span><span class="co">#&gt; 2 cca_23668       2</span></span>
<span><span class="co">#&gt; 3 cca_32926       3</span></span>
<span><span class="co">#&gt; 4 cca_26186       4</span></span>
<span><span class="co">#&gt; 5 cca_24381       5</span></span>
<span><span class="co">#&gt; 6 cca_24396       6</span></span></code></pre></div>
<p>Now that each gene has been assigned to a cluster, we can identify
the phylogenomic profiles of each cluster. This function returns a
matrix of phylogenomic profiles, with clusters in rows and species in
columns.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Phylogenomic profiling</span></span>
<span><span class="va">profiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phylogenomic_profile.html">phylogenomic_profile</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exploring the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">profiles</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;     adu car cca fve gma hlu jcu Lang lja lus mdo mes Mnot mtr pbr pmu ppe ptr</span></span>
<span><span class="co">#&gt;   1   1   1   1   1   2   0   0    2   1   2   2   1    1   1   3   1   1   1</span></span>
<span><span class="co">#&gt;   2   1   1   1   1   1   0   0    1   0   1   1   1    1   1   1   1   1   1</span></span>
<span><span class="co">#&gt;   3   0   1   1   1   1   0   0    1   1   2   1   1    1   1   1   1   1   1</span></span>
<span><span class="co">#&gt;   4   0   1   1   1   2   0   1    2   1   2   0   2    1   1   1   1   1   0</span></span>
<span><span class="co">#&gt;   5   1   1   1   1   2   0   1    0   0   0   1   1    1   1   1   1   1   1</span></span>
<span><span class="co">#&gt;   6   2   1   2   1   3   0   1    2   0   2   2   1    1   2   2   1   1   2</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;     pvu rco roc tpr van vra Zjuj</span></span>
<span><span class="co">#&gt;   1   1   1   1   1   1   1    1</span></span>
<span><span class="co">#&gt;   2   1   0   0   1   1   1    1</span></span>
<span><span class="co">#&gt;   3   1   1   1   1   0   0    1</span></span>
<span><span class="co">#&gt;   4   1   1   0   1   1   0    1</span></span>
<span><span class="co">#&gt;   5   1   1   1   1   1   2    1</span></span>
<span><span class="co">#&gt;   6   1   1   1   1   0   1    1</span></span></code></pre></div>
<p>As a plot is worth a thousand words (or numbers), you can use the
function <code><a href="../reference/plot_profiles.html">plot_profiles()</a></code> to visualize the phylogenomic
profiles as a heatmap with species in rows and synteny network clusters
in columns. The heatmap generated by this function is highly
customizable by users. Some important remarks are:</p>
<ol style="list-style-type: decimal">
<li><p>You can add a legend for species metadata (e.g., taxonomic
information) by passing a 2-column data frame to the parameter
<em>species_annotation</em>.</p></li>
<li><p>Columns (network clusters) are grouped with Ward’s clustering on
a matrix of distances. The method to compute the distance matrix can be
defined by users in parameters <em>dist_function</em> and
<em>dist_params</em>. By default, it uses the function
<code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code> with parameter
<code>method = "euclidean"</code>. Likewise, the function to cluster the
distance matrix and additional parameters can be specified in
<em>clust_function</em> and <em>clust_params</em>. By default, it uses
<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust</a></code> with parameter
<code>method = "ward.D"</code>.</p></li>
<li><p>The order in which species are displayed can be defined by users
in parameter <em>cluster_species</em>. We strongly recommend passing a
vector of species order that matches the species tree, so that patterns
can be explored in a phylogenetic context. Importantly, if the character
vector is named, vector names will be used as species names in the plot.
This a nice way to replace species abbreviations with their full
names.</p></li>
</ol>
<p>Here, to briefly demonstrate how to play with the parameters we just
mentioned in the 3 remarks above, we will:</p>
<ul>
<li><p>Create a vector with the order in which we want species to be
displayed, with longer species names in vector names.</p></li>
<li><p>Create a metadata data frame containing the family of each
species.</p></li>
<li><p>Use the function <code>dsvdis()</code> from the <em><a href="https://CRAN.R-project.org/package=labdsv" class="external-link">labdsv</a></em> package
to calculate Ruzicka distances when clustering columns.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1) Create a named vector of custom species order to plot</span></span>
<span><span class="va">species_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span></span>
<span>    <span class="co"># vector elements</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"vra"</span>, <span class="st">"van"</span>, <span class="st">"pvu"</span>, <span class="st">"gma"</span>, <span class="st">"cca"</span>, <span class="st">"tpr"</span>, <span class="st">"mtr"</span>, <span class="st">"adu"</span>, <span class="st">"lja"</span>,</span>
<span>        <span class="st">"Lang"</span>, <span class="st">"car"</span>, <span class="st">"pmu"</span>, <span class="st">"ppe"</span>, <span class="st">"pbr"</span>, <span class="st">"mdo"</span>, <span class="st">"roc"</span>, <span class="st">"fve"</span>,</span>
<span>        <span class="st">"Mnot"</span>, <span class="st">"Zjuj"</span>, <span class="st">"jcu"</span>, <span class="st">"mes"</span>, <span class="st">"rco"</span>, <span class="st">"lus"</span>, <span class="st">"ptr"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># vector names</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"V. radiata"</span>, <span class="st">"V. angularis"</span>, <span class="st">"P. vulgaris"</span>, <span class="st">"G. max"</span>, <span class="st">"C. cajan"</span>,</span>
<span>        <span class="st">"T. pratense"</span>, <span class="st">"M. truncatula"</span>, <span class="st">"A. duranensis"</span>, <span class="st">"L. japonicus"</span>,</span>
<span>        <span class="st">"L. angustifolius"</span>, <span class="st">"C. arietinum"</span>, <span class="st">"P. mume"</span>, <span class="st">"P. persica"</span>,</span>
<span>        <span class="st">"P. bretschneideri"</span>, <span class="st">"M. domestica"</span>, <span class="st">"R. occidentalis"</span>, </span>
<span>        <span class="st">"F. vesca"</span>, <span class="st">"M. notabilis"</span>, <span class="st">"Z. jujuba"</span>,</span>
<span>        <span class="st">"J. curcas"</span>, <span class="st">"M. esculenta"</span>, <span class="st">"R. communis"</span>, </span>
<span>        <span class="st">"L. usitatissimum"</span>, <span class="st">"P. trichocarpa"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">species_order</span></span>
<span><span class="co">#&gt;        V. radiata      V. angularis       P. vulgaris            G. max </span></span>
<span><span class="co">#&gt;             "vra"             "van"             "pvu"             "gma" </span></span>
<span><span class="co">#&gt;          C. cajan       T. pratense     M. truncatula     A. duranensis </span></span>
<span><span class="co">#&gt;             "cca"             "tpr"             "mtr"             "adu" </span></span>
<span><span class="co">#&gt;      L. japonicus  L. angustifolius      C. arietinum           P. mume </span></span>
<span><span class="co">#&gt;             "lja"            "Lang"             "car"             "pmu" </span></span>
<span><span class="co">#&gt;        P. persica P. bretschneideri      M. domestica   R. occidentalis </span></span>
<span><span class="co">#&gt;             "ppe"             "pbr"             "mdo"             "roc" </span></span>
<span><span class="co">#&gt;          F. vesca      M. notabilis         Z. jujuba         J. curcas </span></span>
<span><span class="co">#&gt;             "fve"            "Mnot"            "Zjuj"             "jcu" </span></span>
<span><span class="co">#&gt;      M. esculenta       R. communis  L. usitatissimum    P. trichocarpa </span></span>
<span><span class="co">#&gt;             "mes"             "rco"             "lus"             "ptr"</span></span>
<span></span>
<span><span class="co"># 2) Create a metadata data frame containing the family of each species</span></span>
<span><span class="va">species_annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Species <span class="op">=</span> <span class="va">species_order</span>,</span>
<span>    Family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Fabaceae"</span>, <span class="fl">11</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Rosaceae"</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>        <span class="st">"Moraceae"</span>, <span class="st">"Ramnaceae"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Euphorbiaceae"</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>        <span class="st">"Linaceae"</span>, <span class="st">"Salicaceae"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">species_annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Species   Family</span></span>
<span><span class="co">#&gt; V. radiata       vra Fabaceae</span></span>
<span><span class="co">#&gt; V. angularis     van Fabaceae</span></span>
<span><span class="co">#&gt; P. vulgaris      pvu Fabaceae</span></span>
<span><span class="co">#&gt; G. max           gma Fabaceae</span></span>
<span><span class="co">#&gt; C. cajan         cca Fabaceae</span></span>
<span><span class="co">#&gt; T. pratense      tpr Fabaceae</span></span>
<span></span>
<span></span>
<span><span class="co"># 3) Plot phylogenomic profiles, but using Ruzicka distances</span></span>
<span><span class="fu"><a href="../reference/plot_profiles.html">plot_profiles</a></span><span class="op">(</span></span>
<span>    <span class="va">profiles</span>, </span>
<span>    <span class="va">species_annotation</span>, </span>
<span>    cluster_species <span class="op">=</span> <span class="va">species_order</span>, </span>
<span>    dist_function <span class="op">=</span> <span class="fu">labdsv</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/labdsv/man/dsvdis.html" class="external-link">dsvdis</a></span>,</span>
<span>    dist_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>index <span class="op">=</span> <span class="st">"ruzicka"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="syntenet_files/figure-html/plot_profiles-1.png" width="700"></p>
<p>The heatmap is a nice way to observe patterns. For instance, you can
see some Rosaceae-specific clusters, Fabaceae-specific clusters, and
highly conserved ones as well.</p>
<p>If you want to explore in more details the group-specific clusters,
you can use the function <code><a href="../reference/find_GS_clusters.html">find_GS_clusters()</a></code>. For that, you
only need to input the profiles matrix and a data frame of species
annotation (i.e., species groups).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find group-specific clusters</span></span>
<span><span class="va">gs_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_GS_clusters.html">find_GS_clusters</a></span><span class="op">(</span><span class="va">profiles</span>, <span class="va">species_annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; Could not find annotation for species: </span></span>
<span><span class="co">#&gt; hlu</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gs_clusters</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Group Percentage Cluster</span></span>
<span><span class="co">#&gt; 2   Fabaceae      90.91    1156</span></span>
<span><span class="co">#&gt; 21  Fabaceae      81.82    1170</span></span>
<span><span class="co">#&gt; 5  Ramnaceae     100.00    1279</span></span>
<span><span class="co">#&gt; 22  Fabaceae      90.91    1305</span></span>
<span><span class="co">#&gt; 23  Fabaceae      81.82    1309</span></span>
<span><span class="co">#&gt; 24  Fabaceae      90.91    1310</span></span>
<span></span>
<span><span class="co"># How many family-specific clusters are there?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">gs_clusters</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 394</span></span></code></pre></div>
<p>As you can see, there are 394 family-specific clusters in the
network. Let’s plot a heatmap of group-specific clusters only.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter profiles matrix to only include group-specific clusters</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">profiles</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">gs_clusters</span><span class="op">$</span><span class="va">Cluster</span></span>
<span><span class="va">p_gs</span> <span class="op">&lt;-</span> <span class="va">profiles</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Plot heatmap</span></span>
<span><span class="fu"><a href="../reference/plot_profiles.html">plot_profiles</a></span><span class="op">(</span></span>
<span>    <span class="va">p_gs</span>, <span class="va">species_annotation</span>, </span>
<span>    cluster_species <span class="op">=</span> <span class="va">species_order</span>, </span>
<span>    cluster_columns <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="syntenet_files/figure-html/heatmap_filtered-1.png" width="700"></p>
<p>Pretty cool, huh? You can also visualize clusters as a network plot
with the function <code><a href="../reference/plot_network.html">plot_network()</a></code>. For example, let’s
visualize the group-specific clusters.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1) Visualize a network of first 5 GS-clusters</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">gs_clusters</span><span class="op">$</span><span class="va">Cluster</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/plot_network.html">plot_network</a></span><span class="op">(</span><span class="va">network</span>, <span class="va">clusters</span>, cluster_id <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p><img src="syntenet_files/figure-html/plot_network-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># 2) Coloring nodes by family</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">node1</span>, <span class="va">network</span><span class="op">$</span><span class="va">node2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gene_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Gene <span class="op">=</span> <span class="va">genes</span>,</span>
<span>    Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">genes</span>, <span class="st">"_"</span><span class="op">)</span>, <span class="va">head</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">gene_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">gene_df</span>, <span class="va">species_annotation</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="st">"Family"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Gene   Family</span></span>
<span><span class="co">#&gt; 1 adu_Aradu.3W61T Fabaceae</span></span>
<span><span class="co">#&gt; 2 adu_Aradu.FQ8CE Fabaceae</span></span>
<span><span class="co">#&gt; 3 adu_Aradu.0W76I Fabaceae</span></span>
<span><span class="co">#&gt; 4 adu_Aradu.M4JP1 Fabaceae</span></span>
<span><span class="co">#&gt; 5 adu_Aradu.B26Z6 Fabaceae</span></span>
<span><span class="co">#&gt; 6 adu_Aradu.PLM7U Fabaceae</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_network.html">plot_network</a></span><span class="op">(</span><span class="va">network</span>, <span class="va">clusters</span>, cluster_id <span class="op">=</span> <span class="va">id</span>, color_by <span class="op">=</span> <span class="va">gene_df</span><span class="op">)</span></span></code></pre></div>
<p><img src="syntenet_files/figure-html/plot_network-2.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># 3) Interactive visualization (zoom out and in to explore it)</span></span>
<span><span class="fu"><a href="../reference/plot_network.html">plot_network</a></span><span class="op">(</span></span>
<span>    <span class="va">network</span>, <span class="va">clusters</span>, cluster_id <span class="op">=</span> <span class="va">id</span>, </span>
<span>    interactive <span class="op">=</span> <span class="cn">TRUE</span>, dim_interactive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">300</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-d7a5d539c9fd1d0826cc" style="width:500px;height:300px;" class="forceNetwork html-widget "></div>
<script type="application/json" data-for="htmlwidget-d7a5d539c9fd1d0826cc">{"x":{"links":{"source":[3,0,2,5,0,2,6,4,3,1,6,8,2,0,7,5,7,0,13,5,4,9,3,6,2,8,12,5,13,14,10,1,11,9,3,4,15,9,15,4,3,19,1,10,18,3,15,19,9,20,4,10,21,18,6,12,8,2,16,0,14,13,7,5,17,8,24,2,6,16,12,19,20,3,15,4,22,23,21,1,18,10,6,26,8,16,24,2,12,0,25,14,13,7,5,17,4,20,3,9,15,22,19,10,23,21,1,18,28,23,18,1,28,10,32,21,8,2,6,12,29,16,24,26,3,31,20,9,22,19,4,15,27,30,5,25,13,14,33,23,32,21,10,1,18,28,26,6,8,24,16,34,29,2,12,22,3,9,31,27,35,20,19,4,15,34,24,16,38,26,2,29,6,8,12,5,14,36,25,13,30,18,33,10,28,21,23,37,1,32,43],"target":[4,5,6,7,7,8,8,9,9,10,12,12,12,13,13,13,14,14,14,14,15,15,15,16,16,16,16,17,17,17,18,18,18,19,19,19,19,20,20,20,20,20,21,21,21,22,22,22,22,22,22,23,23,23,24,24,24,24,24,25,25,25,25,25,25,26,26,26,26,26,26,27,27,27,27,27,27,28,28,28,28,28,29,29,29,29,29,29,29,30,30,30,30,30,30,30,31,31,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,36,36,36,36,36,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,44],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["adu_Aradu.AV6RW","adu_Aradu.E0LH8","adu_Aradu.JF3WA","adu_Aradu.R0IMB","car_03056.1","car_08943.1","car_19495.1","cca_02211","cca_04052","cca_05788","gma_03G097900","gma_07G124000","gma_07G238400","gma_10G041100","gma_13G128000","gma_14G033200","gma_17G035000","Lang_109346054","Lang_109352113","Lang_109355854","Lang_109359285","Lang_109362187","lja_2g3v3059790.1lja","lja_3g3v0642560.1lja","lja_4g3v2263980.1lja","mtr_1g069385","mtr_4g122270","mtr_5g090150","mtr_8g009900","pvu_003G116100","pvu_007G154300","pvu_008G199500","pvu_010G038400","tpr_gene17355","tpr_gene25402","van_01g01830.1","van_06g14500.1","van_08g06220.1","van_11g16300.1","vra_06g02600","vra_07g24530","vra_08g07810","vra_09g06430","Zjuj_107406488","Zjuj_107435072"],"group":["1309","1170","1305","1156","1156","1309","1305","1309","1305","1156","1170","1170","1305","1309","1309","1156","1305","1309","1170","1156","1156","1170","1156","1170","1305","1309","1305","1156","1170","1305","1309","1156","1170","1170","1305","1156","1309","1170","1305","1156","1305","1309","1170","1279","1279"],"nodesize":[" 6"," 8","10","10","10"," 9","10"," 6","10"," 9"," 9"," 1","10"," 9"," 9","10","10"," 5","10","10","10"," 9","10"," 8","10"," 9","10"," 8"," 9","10"," 9"," 9"," 9"," 9","10","10"," 6"," 9","10","10","10"," 6"," 9"," 1"," 1"]},"options":{"NodeID":"name","Group":"Group","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":"serif","clickTextSize":30,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-10,"opacity":0.8,"zoom":true,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="microsynteny-based-phylogeny-reconstruction">Microsynteny-based phylogeny reconstruction<a class="anchor" aria-label="anchor" href="#microsynteny-based-phylogeny-reconstruction"></a>
</h2>
<p>Finally, you can use the information on presence/absence of clusters
in each species to reconstruct a microsynteny-based phylogeny.</p>
<p>To do that, you first need to binarize the profiles matrix (0s and 1s
representing absence and presence, respectively) and transpose it. This
can be done with <code>binarize_and_tranpose()</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binarize_and_transpose.html">binarize_and_transpose</a></span><span class="op">(</span><span class="va">profiles</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Looking at the first 5 rows and 5 columns of the matrix</span></span>
<span><span class="va">bt_mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt;       1 2 3 4 5</span></span>
<span><span class="co">#&gt;   adu 1 1 0 0 1</span></span>
<span><span class="co">#&gt;   car 1 1 1 1 1</span></span>
<span><span class="co">#&gt;   cca 1 1 1 1 1</span></span>
<span><span class="co">#&gt;   fve 1 1 1 1 1</span></span>
<span><span class="co">#&gt;   gma 1 1 1 1 1</span></span></code></pre></div>
<p>Now, you can use this transposed binary matrix as input to IQ-TREE
<span class="citation">(Minh et al. 2020)</span> to infer a phylogeny.
To do so, you can use the function
<code><a href="../reference/infer_microsynteny_phylogeny.html">infer_microsynteny_phylogeny()</a></code>, which allows you to run
IQ-TREE from an R session <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Alternative:&lt;/strong&gt; if you want to use a
different program rather than IQ-TREE, you can use the function
&lt;code&gt;&lt;a href="../reference/profiles2phylip.html"&gt;profiles2phylip()&lt;/a&gt;&lt;/code&gt; to write the transposed binary matrix to
a PHYLIP file and run your favorite program on the command line.
However, when inferring a phylogeny from phylogenomic profiles, you need
to make sure that the program you are using supports substitution models
for binary data. In IQ-TREE, for instance, using binary, morphological
models requires passing parameters &lt;code&gt;-st MORPH&lt;/code&gt;.&lt;/p&gt;'><sup>4</sup></a>. You need to have IQ-TREE installed in your
machine and in your PATH to run this function. You can check if you have
IQ-TREE installed with <code><a href="../reference/iqtree_is_installed.html">iqtree_is_installed()</a></code>.</p>
<p>For the sake of demonstration, we will infer a phylogeny with
<code><a href="../reference/infer_microsynteny_phylogeny.html">infer_microsynteny_phylogeny()</a></code> using the profiles for BUSCO
genes for six legume species only. We will also remove non-variable
sites (i.e., clusters that are present in all species or absent in all
species). However, we’re only using this filtered data set for speed
issues. For real-life applications, the best thing to do is to
<strong>include phylogenomic profiles for all genes</strong> (not only
BUSCO genes).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Leave only 6 legume species and P. mume as an outgroup for testing purposes</span></span>
<span><span class="va">included</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gma"</span>, <span class="st">"pvu"</span>, <span class="st">"vra"</span>, <span class="st">"van"</span>, <span class="st">"cca"</span>, <span class="st">"pmu"</span><span class="op">)</span></span>
<span><span class="va">bt_mat</span> <span class="op">&lt;-</span> <span class="va">bt_mat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bt_mat</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">included</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove non-variable sites</span></span>
<span><span class="va">bt_mat</span> <span class="op">&lt;-</span> <span class="va">bt_mat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">bt_mat</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">included</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="../reference/iqtree_is_installed.html">iqtree_is_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/infer_microsynteny_phylogeny.html">infer_microsynteny_phylogeny</a></span><span class="op">(</span><span class="va">bt_mat</span>, outgroup <span class="op">=</span> <span class="st">"pmu"</span>, </span>
<span>                                          threads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The output of <code><a href="../reference/infer_microsynteny_phylogeny.html">infer_microsynteny_phylogeny()</a></code> is a
character vector with paths to the output files from IQ-TREE. Usually,
you are interested in the file ending in <em>.treefile</em>. This is the
species tree in Newick format, and it can be visualized with your
favorite tree viewer. We strongly recommend using the
<code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree()</a></code> function from the Bioconductor package <em><a href="https://bioconductor.org/packages/3.15/treeio" class="external-link">treeio</a></em>
<span class="citation">(L.-G. Wang et al. 2020)</span> to read the tree,
and visualizing it with the <em><a href="https://bioconductor.org/packages/3.15/ggtree" class="external-link">ggtree</a></em>
Bioc package <span class="citation">(Yu et al. 2017)</span>. For
example, let’s visualize a microsynteny-based phylogeny for 123
angiosperm species, whose phylogenomic profiles were obtained from <span class="citation">Zhao et al. (2021)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">angiosperm_phylogeny</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting the tree</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.amazon.com/Integration-Manipulation-Visualization-Phylogenetic-Computational-ebook/dp/B0B5NLZR1Z/" class="external-link">ggtree</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree</a></span><span class="op">(</span><span class="va">angiosperm_phylogeny</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html" class="external-link">geom_tiplab</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="syntenet_files/figure-html/vis_phylogeny-1.png" width="672"></p>
<div class="section level3">
<h3 id="syntenet-as-a-synteny-detection-tool">
<strong>syntenet</strong> as a synteny detection tool<a class="anchor" aria-label="anchor" href="#syntenet-as-a-synteny-detection-tool"></a>
</h3>
<p>In some cases, users do not want to infer a synteny network, but only
want to identify syntenic regions within a single genome or between two
genomes. This can be accomplished with the functions
<code><a href="../reference/intraspecies_synteny.html">intraspecies_synteny()</a></code> and
<code><a href="../reference/interspecies_synteny.html">interspecies_synteny()</a></code>. In fact, these functions are used
under the hood by <code><a href="../reference/infer_syntenet.html">infer_syntenet()</a></code> to infer a network.</p>
<p>To detect synteny, you will need:</p>
<ol style="list-style-type: decimal">
<li>A list of DIAMOND/BLAST data frames as returned by
<code><a href="../reference/run_diamond.html">run_diamond()</a></code>. For <code><a href="../reference/intraspecies_synteny.html">intraspecies_synteny()</a></code>,
only intraspecies comparisons must be included; for
<code><a href="../reference/interspecies_synteny.html">interspecies_synteny()</a></code>, only interspecies comparisons must
be included.</li>
<li>A <code>GRangesList</code> object containing the processed
annotation for your species of interest, as returned by
<code><a href="../reference/process_input.html">process_input()</a></code>.</li>
</ol>
<p>The output of <code><a href="../reference/intraspecies_synteny.html">intraspecies_synteny()</a></code> and
<code><a href="../reference/interspecies_synteny.html">interspecies_synteny()</a></code> is the path to the
<em>.collinearity</em> files generated by MCScanX <span class="citation">(Y. Wang et al. 2012)</span>, which can be read and
parsed with the <code><a href="../reference/parse_collinearity.html">parse_collinearity()</a></code> function.</p>
<p>To demonstrate the usage of <code><a href="../reference/intraspecies_synteny.html">intraspecies_synteny()</a></code>,
let’s identify syntenic regions in the genome of <em>Saccharomyces
cerevisiae</em>. The processed annotation and DIAMOND output are stored
in the example data sets <code>scerevisiae_annot</code> and
<code>scerevisiae_diamond</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">scerevisiae_annot</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">scerevisiae_diamond</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Take a look at the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scerevisiae_annot</span><span class="op">)</span> </span>
<span><span class="co">#&gt; $Scerevisiae</span></span>
<span><span class="co">#&gt; GRanges object with 6600 ranges and 1 metadata column:</span></span>
<span><span class="co">#&gt;          seqnames        ranges strand |          gene</span></span>
<span><span class="co">#&gt;             &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;character&gt;</span></span>
<span><span class="co">#&gt;      [1]    Sce_I       335-649      * |   Sce_YAL069W</span></span>
<span><span class="co">#&gt;      [2]    Sce_I       538-792      * | Sce_YAL068W-A</span></span>
<span><span class="co">#&gt;      [3]    Sce_I     1807-2169      * |   Sce_YAL068C</span></span>
<span><span class="co">#&gt;      [4]    Sce_I     2480-2707      * | Sce_YAL067W-A</span></span>
<span><span class="co">#&gt;      [5]    Sce_I     7235-9016      * |   Sce_YAL067C</span></span>
<span><span class="co">#&gt;      ...      ...           ...    ... .           ...</span></span>
<span><span class="co">#&gt;   [6596]  Sce_XVI 939922-941136      * |   Sce_YPR201W</span></span>
<span><span class="co">#&gt;   [6597]  Sce_XVI 943032-943896      * |   Sce_YPR202W</span></span>
<span><span class="co">#&gt;   [6598]  Sce_XVI 943880-944188      * |   Sce_YPR203W</span></span>
<span><span class="co">#&gt;   [6599]  Sce_XVI 944603-947701      * |   Sce_YPR204W</span></span>
<span><span class="co">#&gt;   [6600]  Sce_XVI 946856-947338      * | Sce_YPR204C-A</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 17 sequences from an unspecified genome; no seqlengths</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">scerevisiae_diamond</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Scerevisiae_Scerevisiae"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scerevisiae_diamond</span><span class="op">$</span><span class="va">Scerevisiae_Scerevisiae</span><span class="op">)</span></span>
<span><span class="co">#&gt;         query          db perc_identity length mismatches gap_open qstart qend</span></span>
<span><span class="co">#&gt; 1 Sce_YLR106C Sce_YLR106C         100.0   4910          0        0      1 4910</span></span>
<span><span class="co">#&gt; 2 Sce_YKR054C Sce_YKR054C         100.0   4092          0        0      1 4092</span></span>
<span><span class="co">#&gt; 3 Sce_YHR099W Sce_YHR099W         100.0   3744          0        0      1 3744</span></span>
<span><span class="co">#&gt; 4 Sce_YDR457W Sce_YDR457W         100.0   3268          0        0      1 3268</span></span>
<span><span class="co">#&gt; 5 Sce_YDR457W Sce_YER125W          44.1    354        195        3   2913 3266</span></span>
<span><span class="co">#&gt; 6 Sce_YDR457W Sce_YJR036C          30.7    378        228       12   2913 3266</span></span>
<span><span class="co">#&gt;   tstart tend   evalue bitscore</span></span>
<span><span class="co">#&gt; 1      1 4910 0.00e+00     9095</span></span>
<span><span class="co">#&gt; 2      1 4092 0.00e+00     7940</span></span>
<span><span class="co">#&gt; 3      1 3744 0.00e+00     7334</span></span>
<span><span class="co">#&gt; 4      1 3268 0.00e+00     6170</span></span>
<span><span class="co">#&gt; 5    457  807 2.18e-91      315</span></span>
<span><span class="co">#&gt; 6    523  890 7.99e-44      172</span></span>
<span></span>
<span><span class="co"># Detect intragenome synteny</span></span>
<span><span class="va">intra_syn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intraspecies_synteny.html">intraspecies_synteny</a></span><span class="op">(</span></span>
<span>    <span class="va">scerevisiae_diamond</span>, <span class="va">scerevisiae_annot</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">intra_syn</span> <span class="co"># see where the .collinearity file is</span></span>
<span><span class="co">#&gt; [1] "/tmp/Rtmpvw63d2/intra/Scerevisiae.collinearity"</span></span>
<span></span>
<span><span class="co"># Read .collinearity file</span></span>
<span><span class="va">scerevisiae_syn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_collinearity.html">parse_collinearity</a></span><span class="op">(</span><span class="va">intra_syn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scerevisiae_syn</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Anchor1       Anchor2</span></span>
<span><span class="co">#&gt; 1 Sce_YAR050W   Sce_YHR211W</span></span>
<span><span class="co">#&gt; 2 Sce_YAR060C   Sce_YHR212C</span></span>
<span><span class="co">#&gt; 3 Sce_YAR064W Sce_YHR213W-B</span></span>
<span><span class="co">#&gt; 4 Sce_YAR066W   Sce_YHR214W</span></span>
<span><span class="co">#&gt; 5 Sce_YAR068W Sce_YHR214W-A</span></span>
<span><span class="co">#&gt; 6 Sce_YAR069C Sce_YHR214C-D</span></span></code></pre></div>
<p>To demonstrate the usage of <code><a href="../reference/interspecies_synteny.html">interspecies_synteny()</a></code>,
let’s detect syntenic regions between the genomes of <em>Ostreococcus
lucimarinus</em> and <em>Ostreococcus sp RCC809</em>. For these genomes,
we already have processed annotation and the DIAMOND list in the objects
<code>pdata</code> and <code>blast_list</code>, obtained in previous
sections of this vignette.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep only interspecies DIAMOND comparisons</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">blast_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Olucimarinus_Olucimarinus" "Olucimarinus_OspRCC809"   </span></span>
<span><span class="co">#&gt; [3] "OspRCC809_Olucimarinus"    "OspRCC809_OspRCC809"</span></span>
<span><span class="va">diamond_inter</span> <span class="op">&lt;-</span> <span class="va">blast_list</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Double-check if we have processed annotation for these 2 species</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pdata</span><span class="op">$</span><span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Olucimarinus" "OspRCC809"</span></span>
<span></span>
<span><span class="co"># Detect interspecies synteny</span></span>
<span><span class="va">intersyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interspecies_synteny.html">interspecies_synteny</a></span><span class="op">(</span><span class="va">diamond_inter</span>, <span class="va">pdata</span><span class="op">$</span><span class="va">annotation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">intersyn</span> <span class="co"># see where the .collinearity file is</span></span>
<span><span class="co">#&gt; [1] "/tmp/Rtmpvw63d2/inter/Olucimarinus_OspRCC809.collinearity"</span></span>
<span></span>
<span><span class="co"># Read .collinearity file</span></span>
<span><span class="va">ostreoccocus_syn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_collinearity.html">parse_collinearity</a></span><span class="op">(</span><span class="va">intersyn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ostreoccocus_syn</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Anchor1              Anchor2</span></span>
<span><span class="co">#&gt; 1 Olu_OL01G00070 Osp_ORCC809_01G06520</span></span>
<span><span class="co">#&gt; 2 Olu_OL01G00100 Osp_ORCC809_01G06480</span></span>
<span><span class="co">#&gt; 3 Olu_OL01G00130 Osp_ORCC809_01G06440</span></span>
<span><span class="co">#&gt; 4 Olu_OL01G00150 Osp_ORCC809_01G06420</span></span>
<span><span class="co">#&gt; 5 Olu_OL01G00160 Osp_ORCC809_01G06410</span></span>
<span><span class="co">#&gt; 6 Olu_OL01G00170 Osp_ORCC809_01G06400</span></span></code></pre></div>
<p>Note that <code><a href="../reference/parse_collinearity.html">parse_collinearity()</a></code> returns a data frame of
anchor pairs by default, but you can also obtain synteny block
information, or a combination of both by changing the argument to the
<em>as</em> parameter (check the man page with
<code><a href="../reference/parse_collinearity.html">?parse_collinearity</a></code> for details):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1) Get anchors with `parse_collinearity()`</span></span>
<span><span class="va">anchors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_collinearity.html">parse_collinearity</a></span><span class="op">(</span><span class="va">intra_syn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">anchors</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Anchor1       Anchor2</span></span>
<span><span class="co">#&gt; 1 Sce_YAR050W   Sce_YHR211W</span></span>
<span><span class="co">#&gt; 2 Sce_YAR060C   Sce_YHR212C</span></span>
<span><span class="co">#&gt; 3 Sce_YAR064W Sce_YHR213W-B</span></span>
<span><span class="co">#&gt; 4 Sce_YAR066W   Sce_YHR214W</span></span>
<span><span class="co">#&gt; 5 Sce_YAR068W Sce_YHR214W-A</span></span>
<span><span class="co">#&gt; 6 Sce_YAR069C Sce_YHR214C-D</span></span>
<span></span>
<span><span class="co"># 2) Get synteny block with `parse_collinearity()`</span></span>
<span><span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_collinearity.html">parse_collinearity</a></span><span class="op">(</span><span class="va">intra_syn</span>, as <span class="op">=</span> <span class="st">"blocks"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">blocks</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Block Block_score            Chr Orientation</span></span>
<span><span class="co">#&gt; 1     0         446 Sce_I&amp;Sce_VIII        plus</span></span>
<span><span class="co">#&gt; 2     1         528   Sce_I&amp;Sce_XV       minus</span></span>
<span><span class="co">#&gt; 3     2         572  Sce_II&amp;Sce_IV        plus</span></span>
<span><span class="co">#&gt; 4     3         643   Sce_II&amp;Sce_V       minus</span></span>
<span><span class="co">#&gt; 5     4         446 Sce_II&amp;Sce_XVI        plus</span></span>
<span><span class="co">#&gt; 6     5         422 Sce_III&amp;Sce_IV       minus</span></span>
<span></span>
<span><span class="co"># 3) Get synteny blocks and anchor pairs in a single data frame</span></span>
<span><span class="va">all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_collinearity.html">parse_collinearity</a></span><span class="op">(</span><span class="va">intra_syn</span>, as <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">all</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Block Block_score            Chr Orientation     Anchor1       Anchor2</span></span>
<span><span class="co">#&gt; 1     0         446 Sce_I&amp;Sce_VIII        plus Sce_YAR050W   Sce_YHR211W</span></span>
<span><span class="co">#&gt; 2     0         446 Sce_I&amp;Sce_VIII        plus Sce_YAR060C   Sce_YHR212C</span></span>
<span><span class="co">#&gt; 3     0         446 Sce_I&amp;Sce_VIII        plus Sce_YAR064W Sce_YHR213W-B</span></span>
<span><span class="co">#&gt; 4     0         446 Sce_I&amp;Sce_VIII        plus Sce_YAR066W   Sce_YHR214W</span></span>
<span><span class="co">#&gt; 5     0         446 Sce_I&amp;Sce_VIII        plus Sce_YAR068W Sce_YHR214W-A</span></span>
<span><span class="co">#&gt; 6     0         446 Sce_I&amp;Sce_VIII        plus Sce_YAR069C Sce_YHR214C-D</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="faq">FAQ<a class="anchor" aria-label="anchor" href="#faq"></a>
</h2>
<div class="section level3">
<h3 class="unnumbered" id="how-do-i-execute-an-external-dependency-that-is-not-in-my-path">How do I execute an external dependency that is
not in my PATH?<a class="anchor" aria-label="anchor" href="#how-do-i-execute-an-external-dependency-that-is-not-in-my-path"></a>
</h3>
<p>If you have DIAMOND and/or IQ-TREE installed, but in a directory that
is not in your PATH, you can add this given directory to your PATH with
the function <code><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv()</a></code>.</p>
<p>For example, suppose your DIAMOND binary is in
<code>/home/username/bioinfo_tools</code>. To add this directory to your
PATH, you would run:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add example directory /home/username/bioinfo_tools to PATH</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span></span>
<span>    PATH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"PATH"</span><span class="op">)</span>, <span class="st">"/home/username/bioinfo_tools"</span>, sep <span class="op">=</span> <span class="st">":"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that your R PATH is not the same as your system’s PATH. Thus,
even if you add the directory <code>/home/username/bioinfo_tools</code>
to your system’s path (e.g., by editing your ~/.bashrc file if you are
on Linux), you would still need to update your R PATH.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="can-i-run-the-diamond-searches-on-the-command-line-and-import-the-results">Can I run the DIAMOND searches on the command
line and import the results?<a class="anchor" aria-label="anchor" href="#can-i-run-the-diamond-searches-on-the-command-line-and-import-the-results"></a>
</h3>
<p>Yes. This case is quite common for users who have a large amount of
data and want to execute DIAMOND or any similarity search program in an
HPC cluster (by submitting a job with <code>qsub</code> to execute a
Bash script).</p>
<p>To do that, you will have to follow the 3 steps below:</p>
<ol style="list-style-type: decimal">
<li><p>Export the processed sequences (as returned by
<code><a href="../reference/process_input.html">process_input()</a></code>) with the function
<code><a href="../reference/export_sequences.html">export_sequences()</a></code>. This function will write the sequences
to FASTA files in the directory specified in the <strong>outdir</strong>
parameter.</p></li>
<li><p>Navigate (i.e., <code>cd</code>) to the directory specified in
<strong>outdir</strong>, where the FASTA files are, and execute
all-vs-all similarity searches. The output files must be named
“[species]_[species].tsv”, where [species] indicates the basename of the
FASTA files (e.g., “speciesA” for a FASTA file named
<em>speciesA.fasta</em>). For DIAMOND, you can use the following code
(with adaptations, if you prefer):</p></li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create output directories `dbs` and `results`</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> dbs</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> results</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Make dbs for each species</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> seqfile <span class="kw">in</span> <span class="pp">*</span>.fasta</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">dbfile</span><span class="op">=</span><span class="st">"dbs/</span><span class="va">$(</span><span class="fu">basename</span> <span class="st">"</span><span class="va">$seqfile</span><span class="st">"</span> .fasta<span class="va">)</span><span class="st">"</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">diamond</span> makedb <span class="at">--in</span> <span class="st">"</span><span class="va">$seqfile</span><span class="st">"</span> <span class="at">-d</span> <span class="st">"</span><span class="va">$dbfile</span><span class="st">"</span> <span class="at">--quiet</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Perform all-vs-all pairwise similarity searches</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="va">species</span><span class="op">=</span><span class="va">(</span> <span class="va">$(</span><span class="fu">basename</span> <span class="at">-s</span> .fasta <span class="pp">*</span>.fasta<span class="va">)</span> <span class="va">)</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="kw">((</span> <span class="va">i</span><span class="op">=</span><span class="dv">0</span><span class="kw">;</span> <span class="va">i</span><span class="op">&lt;</span><span class="va">${</span><span class="op">#</span><span class="va">species</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="va">i</span><span class="op">++</span> <span class="kw">))</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="va">query</span><span class="op">=</span><span class="st">"</span><span class="va">${species</span><span class="op">[</span><span class="va">$i</span><span class="op">]</span><span class="va">}</span><span class="st">.fasta"</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="kw">((</span> <span class="va">j</span><span class="op">=</span><span class="dv">0</span><span class="kw">;</span> <span class="va">j</span><span class="op">&lt;</span><span class="va">${</span><span class="op">#</span><span class="va">species</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="va">j</span><span class="op">++</span> <span class="kw">))</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">do</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">db</span><span class="op">=</span><span class="st">"dbs/</span><span class="va">${species</span><span class="op">[</span><span class="va">$j</span><span class="op">]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">outfile</span><span class="op">=</span><span class="st">"results/</span><span class="va">${species</span><span class="op">[</span><span class="va">$i</span><span class="op">]</span><span class="va">}</span><span class="st">_</span><span class="va">${species</span><span class="op">[</span><span class="va">$j</span><span class="op">]</span><span class="va">}</span><span class="st">.tsv"</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        <span class="ex">diamond</span> blastp <span class="at">-q</span> <span class="st">"</span><span class="va">$query</span><span class="st">"</span> <span class="at">-d</span> <span class="st">"</span><span class="va">$db</span><span class="st">"</span> <span class="at">-o</span> <span class="st">"</span><span class="va">$outfile</span><span class="st">"</span> <span class="dt">\</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">--max-hsps</span> 1 <span class="at">-k</span> 5 <span class="at">--quiet</span> </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">done</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Read the output of the similarity searches into a list of data
frames with the <code><a href="../reference/read_diamond.html">read_diamond()</a></code> function. As input,
<code><a href="../reference/read_diamond.html">read_diamond()</a></code> takes the path to the directory containing
the DIAMOND/BLAST output files.</li>
</ol>
</div>
<div class="section level3">
<h3 class="unnumbered" id="my-sequence-names-do-not-match-gene-ids-in-the-annotation--what-should-i-do">My sequence names do not match gene IDs in the
annotation. What should I do?<a class="anchor" aria-label="anchor" href="#my-sequence-names-do-not-match-gene-ids-in-the-annotation--what-should-i-do"></a>
</h3>
<p>When the names of your sequences (equivalent to FASTA headers) do not
match the gene IDs in your <code>GRanges</code> objects,
<strong>syntenet</strong> throws the following error:</p>
<blockquote>
<p>Sequence names in ‘seq’ do not match gene names in ‘annotation’.</p>
</blockquote>
<p>In most (if not all) of the cases, this error happens because users
have protein IDs as sequence names, and <strong>syntenet</strong> looks
for gene IDs (i.e., using rows of the <code>GRanges</code> objects for
which the column <em>type</em> is “gene”). This is the case, for
instance, for data obtained from NCBI’s RefSeq database. To solve the
issue, you need to replace <strong>protein/transcript IDs</strong> with
<strong>gene IDs</strong> in sequence names, which can be done with the
function <code><a href="../reference/collapse_protein_ids.html">collapse_protein_ids()</a></code>.</p>
<p>To demonstrate how this works, let’s explore an example data set
containing protein sequences and gene annotation obtained from RefSeq.
The data contains information on a subset of 16 genes from the fish
species <em>Alosa alosa</em>, and it is stored in the
<code>extdata/RefSeq_parsing_example</code> directory of this
package.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Path to directory containing data</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>, <span class="st">"RefSeq_parsing_example"</span>, package <span class="op">=</span> <span class="st">"syntenet"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">data_dir</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Aalosa.fa.gz"   "Aalosa.gff3.gz"</span></span>
<span></span>
<span><span class="co"># Reading the files to a format that syntenet understands</span></span>
<span><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fasta2AAStringSetlist.html">fasta2AAStringSetlist</a></span><span class="op">(</span><span class="va">data_dir</span><span class="op">)</span></span>
<span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gff2GRangesList.html">gff2GRangesList</a></span><span class="op">(</span><span class="va">data_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Taking a look at the data</span></span>
<span><span class="va">seqs</span></span>
<span><span class="co">#&gt; $Aalosa</span></span>
<span><span class="co">#&gt; AAStringSet object of length 21:</span></span>
<span><span class="co">#&gt;      width seq                                              names               </span></span>
<span><span class="co">#&gt;  [1]   189 MTLKMAATMARCFPALVRPLSTR...KRRNWYLNDPYLKYQDRVNPRW XP_048084156.1 39...</span></span>
<span><span class="co">#&gt;  [2]   348 MNEVNRTRLDTDGVRDISSPRRR...HVPYGIAQKVTHKPSISNTAAK XP_048095207.1 cy...</span></span>
<span><span class="co">#&gt;  [3]   177 MPQDLPPAAAVPQGSMPPGKMPH...PALRRRARLRRLVTPEPLYAGW XP_048096060.1 un...</span></span>
<span><span class="co">#&gt;  [4]   176 MPQDLPPAAAVPQGSMPPGKMPH...KERPAGRFYGLPCDAEPVYAGW XP_048096122.1 un...</span></span>
<span><span class="co">#&gt;  [5]   137 MITKAMEVDYKLEDPKAPLEESS...GYRDAFGNELLRRLERLQQNAQ XP_048099323.1 GS...</span></span>
<span><span class="co">#&gt;  ...   ... ...</span></span>
<span><span class="co">#&gt; [17]   224 MGLFGKTSEKPPKDLINEWSLKI...EEEEEEEEDIEEMQTRLAALRS XP_048116262.1 ch...</span></span>
<span><span class="co">#&gt; [18]   176 MSLVRGIMLSATRSKAWSVGRAS...QVLKNPQADHGCSCGSSFSVKL XP_048117248.1 ir...</span></span>
<span><span class="co">#&gt; [19]   149 MAIREVCVLLLPLLALAYAEHVK...WELRDDNNKDLFCIKFPVQIVS XP_048117257.1 NP...</span></span>
<span><span class="co">#&gt; [20]   149 MAIREVCVLLLPLLALAYAEHVK...WELRDDNNKDLFCIKFPVQIVS XP_048117266.1 NP...</span></span>
<span><span class="co">#&gt; [21]   886 MSTSIGDKIEDFKVLTLLGKGSF...VKEKLQCLSSILGLLAGPAARR XP_048120688.1 LO...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">$</span><span class="va">Aalosa</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "XP_048084156.1 39S ribosomal protein L35, mitochondrial [Alosa alosa]"         </span></span>
<span><span class="co">#&gt; [2] "XP_048095207.1 cytosolic 5'-nucleotidase 1A [Alosa alosa]"                     </span></span>
<span><span class="co">#&gt; [3] "XP_048096060.1 uncharacterized protein si:dkey-21a6.5 isoform X1 [Alosa alosa]"</span></span>
<span><span class="co">#&gt; [4] "XP_048096122.1 uncharacterized protein si:dkey-21a6.5 isoform X2 [Alosa alosa]"</span></span>
<span><span class="co">#&gt; [5] "XP_048099323.1 GSK3-beta interaction protein isoform X1 [Alosa alosa]"         </span></span>
<span><span class="co">#&gt; [6] "XP_048099396.1 GSK3-beta interaction protein isoform X2 [Alosa alosa]"</span></span>
<span></span>
<span><span class="va">annot</span></span>
<span><span class="co">#&gt; GRangesList object of length 1:</span></span>
<span><span class="co">#&gt; $Aalosa</span></span>
<span><span class="co">#&gt; GRanges object with 226 ranges and 19 metadata columns:</span></span>
<span><span class="co">#&gt;            seqnames        ranges strand |   source     type     score</span></span>
<span><span class="co">#&gt;               &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;factor&gt; &lt;factor&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;     [1] NC_063189.1    9524-52877      - |   Gnomon     gene        NA</span></span>
<span><span class="co">#&gt;     [2] NC_063189.1   52525-52682      - |   Gnomon     CDS         NA</span></span>
<span><span class="co">#&gt;     [3] NC_063189.1   50374-50600      - |   Gnomon     CDS         NA</span></span>
<span><span class="co">#&gt;     [4] NC_063189.1   38459-38639      - |   Gnomon     CDS         NA</span></span>
<span><span class="co">#&gt;     [5] NC_063189.1   31087-31235      - |   Gnomon     CDS         NA</span></span>
<span><span class="co">#&gt;     ...         ...           ...    ... .      ...      ...       ...</span></span>
<span><span class="co">#&gt;   [222] NC_063189.1 788729-789007      - |   Gnomon      CDS        NA</span></span>
<span><span class="co">#&gt;   [223] NC_063189.1 779818-779990      - |   Gnomon      CDS        NA</span></span>
<span><span class="co">#&gt;   [224] NC_063189.1 778802-778982      - |   Gnomon      CDS        NA</span></span>
<span><span class="co">#&gt;   [225] NC_063189.1 777663-778010      - |   Gnomon      CDS        NA</span></span>
<span><span class="co">#&gt;   [226] NC_063189.1 777553-777626      - |   Gnomon      CDS        NA</span></span>
<span><span class="co">#&gt;             phase                 ID                                  Dbxref</span></span>
<span><span class="co">#&gt;         &lt;integer&gt;        &lt;character&gt;                         &lt;CharacterList&gt;</span></span>
<span><span class="co">#&gt;     [1]      &lt;NA&gt;       gene-noxred1                        GeneID:125303464</span></span>
<span><span class="co">#&gt;     [2]         0 cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1</span></span>
<span><span class="co">#&gt;     [3]         1 cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1</span></span>
<span><span class="co">#&gt;     [4]         2 cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1</span></span>
<span><span class="co">#&gt;     [5]         1 cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1</span></span>
<span><span class="co">#&gt;     ...       ...                ...                                     ...</span></span>
<span><span class="co">#&gt;   [222]         2 cds-XP_048105503.1 GeneID:125298741,Genbank:XP_048105503.1</span></span>
<span><span class="co">#&gt;   [223]         2 cds-XP_048105503.1 GeneID:125298741,Genbank:XP_048105503.1</span></span>
<span><span class="co">#&gt;   [224]         0 cds-XP_048105503.1 GeneID:125298741,Genbank:XP_048105503.1</span></span>
<span><span class="co">#&gt;   [225]         2 cds-XP_048105503.1 GeneID:125298741,Genbank:XP_048105503.1</span></span>
<span><span class="co">#&gt;   [226]         2 cds-XP_048105503.1 GeneID:125298741,Genbank:XP_048105503.1</span></span>
<span><span class="co">#&gt;                   Name       gbkey         gene   gene_biotype     partial</span></span>
<span><span class="co">#&gt;            &lt;character&gt; &lt;character&gt;  &lt;character&gt;    &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt;     [1]        noxred1        Gene      noxred1 protein_coding        true</span></span>
<span><span class="co">#&gt;     [2] XP_048113188.1         CDS      noxred1           &lt;NA&gt;        true</span></span>
<span><span class="co">#&gt;     [3] XP_048113188.1         CDS      noxred1           &lt;NA&gt;        true</span></span>
<span><span class="co">#&gt;     [4] XP_048113188.1         CDS      noxred1           &lt;NA&gt;        true</span></span>
<span><span class="co">#&gt;     [5] XP_048113188.1         CDS      noxred1           &lt;NA&gt;        true</span></span>
<span><span class="co">#&gt;     ...            ...         ...          ...            ...         ...</span></span>
<span><span class="co">#&gt;   [222] XP_048105503.1         CDS LOC125298741           &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [223] XP_048105503.1         CDS LOC125298741           &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [224] XP_048105503.1         CDS LOC125298741           &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [225] XP_048105503.1         CDS LOC125298741           &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [226] XP_048105503.1         CDS LOC125298741           &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;             start_range             Parent                   Note</span></span>
<span><span class="co">#&gt;         &lt;CharacterList&gt;    &lt;CharacterList&gt;        &lt;CharacterList&gt;</span></span>
<span><span class="co">#&gt;     [1]          .,9524                                          </span></span>
<span><span class="co">#&gt;     [2]                 rna-XM_048257231.1 The sequence of the ..</span></span>
<span><span class="co">#&gt;     [3]                 rna-XM_048257231.1 The sequence of the ..</span></span>
<span><span class="co">#&gt;     [4]                 rna-XM_048257231.1 The sequence of the ..</span></span>
<span><span class="co">#&gt;     [5]                 rna-XM_048257231.1 The sequence of the ..</span></span>
<span><span class="co">#&gt;     ...             ...                ...                    ...</span></span>
<span><span class="co">#&gt;   [222]                 rna-XM_048249546.1                       </span></span>
<span><span class="co">#&gt;   [223]                 rna-XM_048249546.1                       </span></span>
<span><span class="co">#&gt;   [224]                 rna-XM_048249546.1                       </span></span>
<span><span class="co">#&gt;   [225]                 rna-XM_048249546.1                       </span></span>
<span><span class="co">#&gt;   [226]                 rna-XM_048249546.1                       </span></span>
<span><span class="co">#&gt;                      exception              inference                product</span></span>
<span><span class="co">#&gt;                    &lt;character&gt;            &lt;character&gt;            &lt;character&gt;</span></span>
<span><span class="co">#&gt;     [1]                   &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     [2] annotated by transcr.. similar to RNA seque.. NADP-dependent oxido..</span></span>
<span><span class="co">#&gt;     [3] annotated by transcr.. similar to RNA seque.. NADP-dependent oxido..</span></span>
<span><span class="co">#&gt;     [4] annotated by transcr.. similar to RNA seque.. NADP-dependent oxido..</span></span>
<span><span class="co">#&gt;     [5] annotated by transcr.. similar to RNA seque.. NADP-dependent oxido..</span></span>
<span><span class="co">#&gt;     ...                    ...                    ...                    ...</span></span>
<span><span class="co">#&gt;   [222]                   &lt;NA&gt;                   &lt;NA&gt; fibroblast growth fa..</span></span>
<span><span class="co">#&gt;   [223]                   &lt;NA&gt;                   &lt;NA&gt; fibroblast growth fa..</span></span>
<span><span class="co">#&gt;   [224]                   &lt;NA&gt;                   &lt;NA&gt; fibroblast growth fa..</span></span>
<span><span class="co">#&gt;   [225]                   &lt;NA&gt;                   &lt;NA&gt; fibroblast growth fa..</span></span>
<span><span class="co">#&gt;   [226]                   &lt;NA&gt;                   &lt;NA&gt; fibroblast growth fa..</span></span>
<span><span class="co">#&gt;             protein_id transl_except</span></span>
<span><span class="co">#&gt;            &lt;character&gt;   &lt;character&gt;</span></span>
<span><span class="co">#&gt;     [1]           &lt;NA&gt;          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     [2] XP_048113188.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     [3] XP_048113188.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     [4] XP_048113188.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     [5] XP_048113188.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     ...            ...           ...</span></span>
<span><span class="co">#&gt;   [222] XP_048105503.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [223] XP_048105503.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [224] XP_048105503.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [225] XP_048105503.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [226] XP_048105503.1          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code></pre></div>
<p>The first problem we can observe is that sequence names have
additional text describing the sequences (e.g., “GSK3-beta…”), and we
must have only the IDs. To solve this issue, we can remove whitespace
and everything that comes after it.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove whitespace and everything after it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">$</span><span class="va">Aalosa</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" .*"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">$</span><span class="va">Aalosa</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Taking a look at the new names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">$</span><span class="va">Aalosa</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "XP_048084156.1" "XP_048095207.1" "XP_048096060.1" "XP_048096122.1"</span></span>
<span><span class="co">#&gt; [5] "XP_048099323.1" "XP_048099396.1"</span></span></code></pre></div>
<p>Great, we removed the unnecessary text! However, there is still a
problem: sequence names start with <em>XP_….</em>. If you look closer at
the first row of <code>annot$Aalosa</code> (which contains ranges for
genes), you will notice that none of the columns contain such
<em>XP_…</em> IDs. This is because RefSeq uses such IDs for CDS, not for
genes. Let’s check if we can indeed find the <em>XP_…</em> IDs in rows
that have “CDS” in the <code>type</code> column.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show only rows for which `type` is "CDS"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">annot</span><span class="op">$</span><span class="va">Aalosa</span><span class="op">[</span><span class="va">annot</span><span class="op">$</span><span class="va">Aalosa</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"CDS"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRanges object with 6 ranges and 19 metadata columns:</span></span>
<span><span class="co">#&gt;          seqnames        ranges strand |   source     type     score     phase</span></span>
<span><span class="co">#&gt;             &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;factor&gt; &lt;factor&gt; &lt;numeric&gt; &lt;integer&gt;</span></span>
<span><span class="co">#&gt;   [1] NC_063189.1   52525-52682      - |   Gnomon      CDS        NA         0</span></span>
<span><span class="co">#&gt;   [2] NC_063189.1   50374-50600      - |   Gnomon      CDS        NA         1</span></span>
<span><span class="co">#&gt;   [3] NC_063189.1   38459-38639      - |   Gnomon      CDS        NA         2</span></span>
<span><span class="co">#&gt;   [4] NC_063189.1   31087-31235      - |   Gnomon      CDS        NA         1</span></span>
<span><span class="co">#&gt;   [5] NC_063189.1     9524-9713      - |   Gnomon      CDS        NA         2</span></span>
<span><span class="co">#&gt;   [6] NC_063189.1 229429-229590      - |   Gnomon      CDS        NA         0</span></span>
<span><span class="co">#&gt;                       ID                                  Dbxref           Name</span></span>
<span><span class="co">#&gt;              &lt;character&gt;                         &lt;CharacterList&gt;    &lt;character&gt;</span></span>
<span><span class="co">#&gt;   [1] cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1 XP_048113188.1</span></span>
<span><span class="co">#&gt;   [2] cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1 XP_048113188.1</span></span>
<span><span class="co">#&gt;   [3] cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1 XP_048113188.1</span></span>
<span><span class="co">#&gt;   [4] cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1 XP_048113188.1</span></span>
<span><span class="co">#&gt;   [5] cds-XP_048113188.1 GeneID:125303464,Genbank:XP_048113188.1 XP_048113188.1</span></span>
<span><span class="co">#&gt;   [6] cds-XP_048105299.1 GeneID:125298558,Genbank:XP_048105299.1 XP_048105299.1</span></span>
<span><span class="co">#&gt;             gbkey        gene gene_biotype     partial     start_range</span></span>
<span><span class="co">#&gt;       &lt;character&gt; &lt;character&gt;  &lt;character&gt; &lt;character&gt; &lt;CharacterList&gt;</span></span>
<span><span class="co">#&gt;   [1]         CDS     noxred1         &lt;NA&gt;        true                </span></span>
<span><span class="co">#&gt;   [2]         CDS     noxred1         &lt;NA&gt;        true                </span></span>
<span><span class="co">#&gt;   [3]         CDS     noxred1         &lt;NA&gt;        true                </span></span>
<span><span class="co">#&gt;   [4]         CDS     noxred1         &lt;NA&gt;        true                </span></span>
<span><span class="co">#&gt;   [5]         CDS     noxred1         &lt;NA&gt;        true          .,9524</span></span>
<span><span class="co">#&gt;   [6]         CDS       atg2b         &lt;NA&gt;        &lt;NA&gt;                </span></span>
<span><span class="co">#&gt;                   Parent                   Note              exception</span></span>
<span><span class="co">#&gt;          &lt;CharacterList&gt;        &lt;CharacterList&gt;            &lt;character&gt;</span></span>
<span><span class="co">#&gt;   [1] rna-XM_048257231.1 The sequence of the .. annotated by transcr..</span></span>
<span><span class="co">#&gt;   [2] rna-XM_048257231.1 The sequence of the .. annotated by transcr..</span></span>
<span><span class="co">#&gt;   [3] rna-XM_048257231.1 The sequence of the .. annotated by transcr..</span></span>
<span><span class="co">#&gt;   [4] rna-XM_048257231.1 The sequence of the .. annotated by transcr..</span></span>
<span><span class="co">#&gt;   [5] rna-XM_048257231.1 The sequence of the .. annotated by transcr..</span></span>
<span><span class="co">#&gt;   [6] rna-XM_048249342.1 The sequence of the .. unclassified transla..</span></span>
<span><span class="co">#&gt;                    inference                product     protein_id</span></span>
<span><span class="co">#&gt;                  &lt;character&gt;            &lt;character&gt;    &lt;character&gt;</span></span>
<span><span class="co">#&gt;   [1] similar to RNA seque.. NADP-dependent oxido.. XP_048113188.1</span></span>
<span><span class="co">#&gt;   [2] similar to RNA seque.. NADP-dependent oxido.. XP_048113188.1</span></span>
<span><span class="co">#&gt;   [3] similar to RNA seque.. NADP-dependent oxido.. XP_048113188.1</span></span>
<span><span class="co">#&gt;   [4] similar to RNA seque.. NADP-dependent oxido.. XP_048113188.1</span></span>
<span><span class="co">#&gt;   [5] similar to RNA seque.. NADP-dependent oxido.. XP_048113188.1</span></span>
<span><span class="co">#&gt;   [6]                   &lt;NA&gt; LOW QUALITY PROTEIN:.. XP_048105299.1</span></span>
<span><span class="co">#&gt;       transl_except</span></span>
<span><span class="co">#&gt;         &lt;character&gt;</span></span>
<span><span class="co">#&gt;   [1]          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [2]          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [3]          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [4]          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [5]          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   [6]          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code></pre></div>
<p>The <em>XP_…</em> IDs can be found in the <code>Name</code> column.
Note also that the gene IDs, which are what we need for
<strong>syntenet</strong>, are in the <code>gene</code> column. To
collapse protein IDs to gene IDs with
<code><a href="../reference/collapse_protein_ids.html">collapse_protein_ids()</a></code>, we will need to create a list of
2-column data frames containing the correspondence between protein IDs
and gene IDs for each species. In this example, we can do that by
extracting the columns <code>Name</code> and <code>gene</code> from rows
that represent CDS ranges.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a list of data frames containing protein-to-gene ID correspondences</span></span>
<span><span class="va">protein2gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">annot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># Extract only CDS ranges</span></span>
<span>    <span class="va">cds_ranges</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"CDS"</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Create the ID correspondence data frame</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        protein_id <span class="op">=</span> <span class="va">cds_ranges</span><span class="op">$</span><span class="va">Name</span>,</span>
<span>        gene_id <span class="op">=</span> <span class="va">cds_ranges</span><span class="op">$</span><span class="va">gene</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Remove duplicate rows</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">protein_id</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Taking a look at the list</span></span>
<span><span class="va">protein2gene</span></span>
<span><span class="co">#&gt; $Aalosa</span></span>
<span><span class="co">#&gt;         protein_id        gene_id</span></span>
<span><span class="co">#&gt; 1   XP_048113188.1        noxred1</span></span>
<span><span class="co">#&gt; 6   XP_048105299.1          atg2b</span></span>
<span><span class="co">#&gt; 47  XP_048099323.1   LOC125294505</span></span>
<span><span class="co">#&gt; 50  XP_048099476.1   LOC125294505</span></span>
<span><span class="co">#&gt; 52  XP_048099396.1   LOC125294505</span></span>
<span><span class="co">#&gt; 54  XP_048099557.1   LOC125294505</span></span>
<span><span class="co">#&gt; 56  XP_048117257.1   LOC125306123</span></span>
<span><span class="co">#&gt; 60  XP_048117266.1   LOC125306123</span></span>
<span><span class="co">#&gt; 64  XP_048117248.1          isca2</span></span>
<span><span class="co">#&gt; 68  XP_048105318.1           eml5</span></span>
<span><span class="co">#&gt; 119 XP_048103211.1         itpk1b</span></span>
<span><span class="co">#&gt; 130 XP_048115651.1   LOC125305081</span></span>
<span><span class="co">#&gt; 132 XP_048120688.1           plk4</span></span>
<span><span class="co">#&gt; 149 XP_048105359.1         hspa4l</span></span>
<span><span class="co">#&gt; 168 XP_048116262.1          chmp3</span></span>
<span><span class="co">#&gt; 176 XP_048111661.1          reep1</span></span>
<span><span class="co">#&gt; 183 XP_048084156.1         mrpl35</span></span>
<span><span class="co">#&gt; 187 XP_048096060.1 si:dkey-21a6.5</span></span>
<span><span class="co">#&gt; 192 XP_048096122.1 si:dkey-21a6.5</span></span>
<span><span class="co">#&gt; 197 XP_048095207.1        nt5c1ab</span></span>
<span><span class="co">#&gt; 203 XP_048105503.1   LOC125298741</span></span></code></pre></div>
<p>Finally, we can pass the list of sequences and the list of ID
correspondences to <code><a href="../reference/collapse_protein_ids.html">collapse_protein_ids()</a></code>, which will
return a list of <code>AAStringSet</code> objects with gene IDs in
sequence names.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Collapse protein IDs to gene IDs in list of sequences</span></span>
<span><span class="va">new_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collapse_protein_ids.html">collapse_protein_ids</a></span><span class="op">(</span><span class="va">seqs</span>, <span class="va">protein2gene</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Looking at the new sequences</span></span>
<span><span class="va">new_seq</span></span>
<span><span class="co">#&gt; $Aalosa</span></span>
<span><span class="co">#&gt; AAStringSet object of length 16:</span></span>
<span><span class="co">#&gt;      width seq                                              names               </span></span>
<span><span class="co">#&gt;  [1]  1946 MADRTAPNCHLRLEWVYGYRGHQ...YVISAGGDDRSLFVWKCVHTPH eml5</span></span>
<span><span class="co">#&gt;  [2]  1882 MPWPFSESIKKRACRYLLHRYLG...MRNQIQPDARQEETQKWRLGEE atg2b</span></span>
<span><span class="co">#&gt;  [3]   886 MSTSIGDKIEDFKVLTLLGKGSF...VKEKLQCLSSILGLLAGPAARR plk4</span></span>
<span><span class="co">#&gt;  [4]   769 MSVVGFDVGFQNCYIAVARSGGI...GGDAKSGGSSHQPAAPGEMEVE hspa4l</span></span>
<span><span class="co">#&gt;  [5]   480 MAAPAYVFGQKVWLSARISPLRV...HTHTHAHLESKVHQHQHIHFQC LOC125298741</span></span>
<span><span class="co">#&gt;  ...   ... ...</span></span>
<span><span class="co">#&gt; [12]   189 MTLKMAATMARCFPALVRPLSTR...KRRNWYLNDPYLKYQDRVNPRW mrpl35</span></span>
<span><span class="co">#&gt; [13]   177 MPQDLPPAAAVPQGSMPPGKMPH...PALRRRARLRRLVTPEPLYAGW si:dkey-21a6.5</span></span>
<span><span class="co">#&gt; [14]   176 MSLVRGIMLSATRSKAWSVGRAS...QVLKNPQADHGCSCGSSFSVKL isca2</span></span>
<span><span class="co">#&gt; [15]   149 MAIREVCVLLLPLLALAYAEHVK...WELRDDNNKDLFCIKFPVQIVS LOC125306123</span></span>
<span><span class="co">#&gt; [16]   137 MITKAMEVDYKLEDPKAPLEESS...GYRDAFGNELLRRLERLQQNAQ LOC125294505</span></span></code></pre></div>
<p>As you can see, protein IDs have been replaced with gene IDs. If
there are multiple proteins for the same gene (i.e., different
isoforms), the function keeps only the longest sequence (also known as
protein products of the primary transcript). This way, the number of
sequences will never be greater than the number of genes, which is what
<strong>syntenet</strong> expects.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<p>This document was created under the following conditions:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 20.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggtree_3.4.4     syntenet_1.3.3   BiocStyle_2.24.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] nlme_3.1-162                labdsv_2.1-0               </span></span>
<span><span class="co">#&gt;   [3] bitops_1.0-7                matrixStats_1.0.0          </span></span>
<span><span class="co">#&gt;   [5] fs_1.6.2                    RColorBrewer_1.1-3         </span></span>
<span><span class="co">#&gt;   [7] rprojroot_2.0.3             GenomeInfoDb_1.32.4        </span></span>
<span><span class="co">#&gt;   [9] tools_4.2.1                 bslib_0.4.2                </span></span>
<span><span class="co">#&gt;  [11] utf8_1.2.3                  R6_2.5.1                   </span></span>
<span><span class="co">#&gt;  [13] lazyeval_0.2.2              mgcv_1.8-42                </span></span>
<span><span class="co">#&gt;  [15] BiocGenerics_0.42.0         colorspace_2.1-0           </span></span>
<span><span class="co">#&gt;  [17] withr_2.5.0                 tidyselect_1.2.0           </span></span>
<span><span class="co">#&gt;  [19] compiler_4.2.1              textshaping_0.3.6          </span></span>
<span><span class="co">#&gt;  [21] cli_3.6.1                   Biobase_2.56.0             </span></span>
<span><span class="co">#&gt;  [23] intergraph_2.0-2            network_1.18.1             </span></span>
<span><span class="co">#&gt;  [25] desc_1.4.2                  DelayedArray_0.22.0        </span></span>
<span><span class="co">#&gt;  [27] labeling_0.4.2              rtracklayer_1.56.1         </span></span>
<span><span class="co">#&gt;  [29] bookdown_0.34               sass_0.4.6                 </span></span>
<span><span class="co">#&gt;  [31] scales_1.2.1                pkgdown_2.0.7              </span></span>
<span><span class="co">#&gt;  [33] yulab.utils_0.0.6           systemfonts_1.0.4          </span></span>
<span><span class="co">#&gt;  [35] stringr_1.5.0               digest_0.6.31              </span></span>
<span><span class="co">#&gt;  [37] Rsamtools_2.12.0            rmarkdown_2.22             </span></span>
<span><span class="co">#&gt;  [39] XVector_0.36.0              pkgconfig_2.0.3            </span></span>
<span><span class="co">#&gt;  [41] htmltools_0.5.5             MatrixGenerics_1.8.1       </span></span>
<span><span class="co">#&gt;  [43] highr_0.10                  fastmap_1.1.1              </span></span>
<span><span class="co">#&gt;  [45] htmlwidgets_1.6.2           rlang_1.1.1                </span></span>
<span><span class="co">#&gt;  [47] gridGraphics_0.5-1          farver_2.1.1               </span></span>
<span><span class="co">#&gt;  [49] jquerylib_0.1.4             BiocIO_1.6.0               </span></span>
<span><span class="co">#&gt;  [51] generics_0.1.3              jsonlite_1.8.5             </span></span>
<span><span class="co">#&gt;  [53] statnet.common_4.9.0        BiocParallel_1.30.4        </span></span>
<span><span class="co">#&gt;  [55] dplyr_1.1.2                 RCurl_1.98-1.12            </span></span>
<span><span class="co">#&gt;  [57] magrittr_2.0.3              ggplotify_0.1.0            </span></span>
<span><span class="co">#&gt;  [59] ggnetwork_0.5.12            GenomeInfoDbData_1.2.8     </span></span>
<span><span class="co">#&gt;  [61] patchwork_1.1.2             Matrix_1.5-4.1             </span></span>
<span><span class="co">#&gt;  [63] Rcpp_1.0.10                 munsell_0.5.0              </span></span>
<span><span class="co">#&gt;  [65] S4Vectors_0.34.0            fansi_1.0.4                </span></span>
<span><span class="co">#&gt;  [67] ape_5.7-1                   lifecycle_1.0.3            </span></span>
<span><span class="co">#&gt;  [69] stringi_1.7.12              yaml_2.3.7                 </span></span>
<span><span class="co">#&gt;  [71] MASS_7.3-60                 SummarizedExperiment_1.26.1</span></span>
<span><span class="co">#&gt;  [73] zlibbioc_1.42.0             Rtsne_0.16                 </span></span>
<span><span class="co">#&gt;  [75] grid_4.2.1                  parallel_4.2.1             </span></span>
<span><span class="co">#&gt;  [77] crayon_1.5.2                lattice_0.21-8             </span></span>
<span><span class="co">#&gt;  [79] splines_4.2.1               Biostrings_2.64.1          </span></span>
<span><span class="co">#&gt;  [81] knitr_1.43                  pillar_1.9.0               </span></span>
<span><span class="co">#&gt;  [83] igraph_1.4.3                GenomicRanges_1.48.0       </span></span>
<span><span class="co">#&gt;  [85] rjson_0.2.21                codetools_0.2-19           </span></span>
<span><span class="co">#&gt;  [87] stats4_4.2.1                XML_3.99-0.14              </span></span>
<span><span class="co">#&gt;  [89] glue_1.6.2                  evaluate_0.21              </span></span>
<span><span class="co">#&gt;  [91] ggfun_0.0.9                 BiocManager_1.30.20        </span></span>
<span><span class="co">#&gt;  [93] treeio_1.20.2               vctrs_0.6.2                </span></span>
<span><span class="co">#&gt;  [95] networkD3_0.4               tidyr_1.3.0                </span></span>
<span><span class="co">#&gt;  [97] gtable_0.3.3                purrr_1.0.1                </span></span>
<span><span class="co">#&gt;  [99] cachem_1.0.8                ggplot2_3.4.2              </span></span>
<span><span class="co">#&gt; [101] xfun_0.39                   restfulr_0.0.15            </span></span>
<span><span class="co">#&gt; [103] tidytree_0.4.2              coda_0.19-4                </span></span>
<span><span class="co">#&gt; [105] ragg_1.2.5                  tibble_3.2.1               </span></span>
<span><span class="co">#&gt; [107] pheatmap_1.0.12             aplot_0.1.10               </span></span>
<span><span class="co">#&gt; [109] GenomicAlignments_1.32.1    memoise_2.0.1              </span></span>
<span><span class="co">#&gt; [111] IRanges_2.30.1              cluster_2.1.4              </span></span>
<span><span class="co">#&gt; [113] ellipsis_0.3.2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-altschul1997gapped" class="csl-entry">
Altschul, Stephen F, Thomas L Madden, Alejandro A Schäffer, Jinghui
Zhang, Zheng Zhang, Webb Miller, and David J Lipman. 1997. <span>“Gapped
BLAST and PSI-BLAST: A New Generation of Protein Database Search
Programs.”</span> <em>Nucleic Acids Research</em> 25 (17): 3389–3402.
</div>
<div id="ref-buchfink2021sensitive" class="csl-entry">
Buchfink, Benjamin, Klaus Reuter, and Hajk-Georg Drost. 2021.
<span>“Sensitive Protein Alignments at Tree-of-Life Scale Using
DIAMOND.”</span> <em>Nature Methods</em> 18 (4): 366–68.
</div>
<div id="ref-eddelbuettel2011rcpp" class="csl-entry">
Eddelbuettel, Dirk, and Romain François. 2011. <span>“Rcpp: Seamless r
and c++ Integration.”</span> <em>Journal of Statistical Software</em>
40: 1–18.
</div>
<div id="ref-lange2021cliquepercolation" class="csl-entry">
Lange, Jens. 2021. <span>“CliquePercolation: An r Package for Conducting
and Visualizing Results of the Clique Percolation Network Community
Detection Algorithm.”</span> <em>Journal of Open Source Software</em> 6
(62): 3210.
</div>
<div id="ref-minh2020iq" class="csl-entry">
Minh, Bui Quang, Heiko A Schmidt, Olga Chernomor, Dominik Schrempf,
Michael D Woodhams, Arndt Von Haeseler, and Robert Lanfear. 2020.
<span>“IQ-TREE 2: New Models and Efficient Methods for Phylogenetic
Inference in the Genomic Era.”</span> <em>Molecular Biology and
Evolution</em> 37 (5): 1530–34.
</div>
<div id="ref-vandepoele2013pico" class="csl-entry">
Vandepoele, Klaas, Michiel Van Bel, Guilhem Richard, Sofie Van
Landeghem, Bram Verhelst, Hervé Moreau, Yves Van de Peer, Nigel
Grimsley, and Gwenael Piganeau. 2013. <span>“Pico-PLAZA, a Genome
Database of Microbial Photosynthetic Eukaryotes.”</span>
<em>Environmental Microbiology</em> 15 (8): 2147–53.
</div>
<div id="ref-wang2020treeio" class="csl-entry">
Wang, Li-Gen, Tommy Tsan-Yuk Lam, Shuangbin Xu, Zehan Dai, Lang Zhou,
Tingze Feng, Pingfan Guo, et al. 2020. <span>“Treeio: An r Package for
Phylogenetic Tree Input and Output with Richly Annotated and Associated
Data.”</span> <em>Molecular Biology and Evolution</em> 37 (2): 599–603.
</div>
<div id="ref-wang2012mcscanx" class="csl-entry">
Wang, Yupeng, Haibao Tang, Jeremy D DeBarry, Xu Tan, Jingping Li, Xiyin
Wang, Tae-ho Lee, et al. 2012. <span>“MCScanX: A Toolkit for Detection
and Evolutionary Analysis of Gene Synteny and Collinearity.”</span>
<em>Nucleic Acids Research</em> 40 (7): e49–49.
</div>
<div id="ref-yu2017ggtree" class="csl-entry">
Yu, Guangchuang, David K Smith, Huachen Zhu, Yi Guan, and Tommy Tsan-Yuk
Lam. 2017. <span>“Ggtree: An r Package for Visualization and Annotation
of Phylogenetic Trees with Their Covariates and Other Associated
Data.”</span> <em>Methods in Ecology and Evolution</em> 8 (1): 28–36.
</div>
<div id="ref-zhao2017phylogenomic" class="csl-entry">
Zhao, Tao, Rens Holmer, Suzanne de Bruijn, Gerco C Angenent, Harrold A
van den Burg, and M Eric Schranz. 2017. <span>“Phylogenomic Synteny
Network Analysis of MADS-Box Transcription Factor Genes Reveals
Lineage-Specific Transpositions, Ancient Tandem Duplications, and Deep
Positional Conservation.”</span> <em>The Plant Cell</em> 29 (6):
1278–92.
</div>
<div id="ref-zhao2017network" class="csl-entry">
Zhao, Tao, and M Eric Schranz. 2017. <span>“Network Approaches for Plant
Phylogenomic Synteny Analysis.”</span> <em>Current Opinion in Plant
Biology</em> 36: 129–34.
</div>
<div id="ref-zhao2019network" class="csl-entry">
———. 2019. <span>“Network-Based Microsynteny Analysis Identifies Major
Differences and Genomic Outliers in Mammalian and Angiosperm
Genomes.”</span> <em>Proceedings of the National Academy of
Sciences</em> 116 (6): 2165–74.
</div>
<div id="ref-zhao2021whole" class="csl-entry">
Zhao, Tao, Arthur Zwaenepoel, Jia-Yu Xue, Shu-Min Kao, Zhen Li, M Eric
Schranz, and Yves Van de Peer. 2021. <span>“Whole-Genome
Microsynteny-Based Phylogeny of Angiosperms.”</span> <em>Nature
Communications</em> 12 (1): 1–14.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Fabrício Almeida-Silva, Tao Zhao, Kristian K Ullrich, Yves Van de Peer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
