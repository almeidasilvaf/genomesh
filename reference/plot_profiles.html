<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plot a heatmap of phylogenomic profiles"><title>Plot a heatmap of phylogenomic profiles — plot_profiles • syntenet</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.6/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a heatmap of phylogenomic profiles — plot_profiles"><meta property="og:description" content="Plot a heatmap of phylogenomic profiles"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-#0092ac"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">syntenet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/syntenet.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/almeidasilvaf/syntenet/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot a heatmap of phylogenomic profiles</h1>
      <small class="dont-index">Source: <a href="https://github.com/almeidasilvaf/syntenet/blob/HEAD/R/06_dataviz.R" class="external-link"><code>R/06_dataviz.R</code></a></small>
      <div class="d-none name"><code>plot_profiles.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot a heatmap of phylogenomic profiles</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_profiles</span><span class="op">(</span></span>
<span>  profile_matrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  species_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"Greens"</span>,</span>
<span>  dist_function <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span>,</span>
<span>  dist_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span>,</span>
<span>  clust_function <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span>,</span>
<span>  clust_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span>,</span>
<span>  cluster_species <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_colnames <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  discretize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>profile_matrix</dt>
<dd><p>A matrix of phylogenomic profiles obtained
with <code>phylogenomic_profile</code>.</p></dd>


<dt>species_annotation</dt>
<dd><p>A 2-column data frame with species IDs in
the first column (same as column names of profile matrix), and species
annotation (e.g., higher-level taxonomic information) in the second column.</p></dd>


<dt>palette</dt>
<dd><p>A character vector of colors or a character scalar with
the name of an RColorBrewer palette. Default: "RdYlBu".</p></dd>


<dt>dist_function</dt>
<dd><p>Function to use to calculate a distance matrix for
synteny clusters. Popular examples include <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist</a></code>,
<code><a href="https://rdrr.io/pkg/labdsv/man/dsvdis.html" class="external-link">labdsv::dsvdis</a></code>, and <code>vegan::vegdist</code>. Default: stats::dist.</p></dd>


<dt>dist_params</dt>
<dd><p>A list with parameters to be passed to the function
specified in parameter <strong>dist_function</strong>.
Default: list(method = "euclidean").</p></dd>


<dt>clust_function</dt>
<dd><p>Function to use to cluster the distance matrix
returned by the function specified in <code>dist_function</code>. Examples include
<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust</a></code> and <code>Rclusterpp::Rclusterpp.hclust</code>.
Default: stats::hclust.</p></dd>


<dt>clust_params</dt>
<dd><p>A list with additional parameters (if any) to be
passed to the function specified in parameter <strong>clust_function</strong>.
Default: list(method = "ward.D").</p></dd>


<dt>cluster_species</dt>
<dd><p>Either a logical scalar (TRUE or FALSE) or
a character vector with the order in which species should be arranged.
TRUE or FALSE indicate whether hierarchical clustering should be applied
to rows (species). Ideally, the character vector
should contain the order of species in a phylogenetically meaningful way.
If users pass a named vector, vector names will be used to rename species.
If users have a species tree, they can read it
with <code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">treeio::read.tree()</a></code>, plot it with <code><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree::ggtree()</a></code>,
and get the species order from the ggtree object
with <code><a href="https://rdrr.io/pkg/ggtree/man/get_taxa_name.html" class="external-link">ggtree::get_taxa_name()</a></code>. Default: FALSE.</p></dd>


<dt>show_colnames</dt>
<dd><p>Logical indicating whether to show column names (i.e.,
cluster IDs) or not. Showing cluster IDs can be useful when visualizing
a small subset of them. When visualizing all clusters, cluster IDs are
impossible to read. Default: FALSE.</p></dd>


<dt>discretize</dt>
<dd><p>Logical indicating whether to discretize clusters in
4 categories: 0, 1, 2, and 3+. If FALSE, counts will be
log2 transformed. Default: TRUE.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters to <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap::pheatmap()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A pheatmap object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">profile_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="phylogenomic_profile.html">phylogenomic_profile</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">species_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"vra"</span>, <span class="st">"van"</span>, <span class="st">"pvu"</span>, <span class="st">"gma"</span>, <span class="st">"cca"</span>, <span class="st">"tpr"</span>, <span class="st">"mtr"</span>, <span class="st">"adu"</span>, <span class="st">"lja"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Lang"</span>, <span class="st">"car"</span>, <span class="st">"pmu"</span>, <span class="st">"ppe"</span>, <span class="st">"pbr"</span>, <span class="st">"mdo"</span>, <span class="st">"roc"</span>, <span class="st">"fve"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Mnot"</span>, <span class="st">"Zjuj"</span>, <span class="st">"jcu"</span>, <span class="st">"mes"</span>, <span class="st">"rco"</span>, <span class="st">"lus"</span>, <span class="st">"ptr"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">species_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"V. radiata"</span>, <span class="st">"V. angularis"</span>, <span class="st">"P. vulgaris"</span>, <span class="st">"G. max"</span>, <span class="st">"C. cajan"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"T. pratense"</span>, <span class="st">"M. truncatula"</span>, <span class="st">"A. duranensis"</span>, <span class="st">"L. japonicus"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"L. angustifolius"</span>, <span class="st">"C. arietinum"</span>, <span class="st">"P. mume"</span>, <span class="st">"P. persica"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"P. bretschneideri"</span>, <span class="st">"M. domestica"</span>, <span class="st">"R. occidentalis"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"F. vesca"</span>, <span class="st">"M. notabilis"</span>, <span class="st">"Z. jujuba"</span>, <span class="st">"J. curcas"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"M. esculenta"</span>, <span class="st">"R. communis"</span>, <span class="st">"L. usitatissimum"</span>, <span class="st">"P. trichocarpa"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">species_order</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">species_names</span></span></span>
<span class="r-in"><span><span class="va">species_annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   Species <span class="op">=</span> <span class="va">species_order</span>,</span></span>
<span class="r-in"><span>   Family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Fabaceae"</span>, <span class="fl">11</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Rosaceae"</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              <span class="st">"Moraceae"</span>, <span class="st">"Ramnaceae"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Euphorbiaceae"</span>, <span class="fl">3</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              <span class="st">"Linaceae"</span>, <span class="st">"Salicaceae"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plot_profiles</span><span class="op">(</span><span class="va">profile_matrix</span>, <span class="va">species_annotation</span>, </span></span>
<span class="r-in"><span>                   cluster_species <span class="op">=</span> <span class="va">species_order</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_profiles-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>                   </span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plot_profiles</span><span class="op">(</span><span class="va">profile_matrix</span>, <span class="va">species_annotation</span>, </span></span>
<span class="r-in"><span>                   cluster_species <span class="op">=</span> <span class="va">species_order</span>, </span></span>
<span class="r-in"><span>                   discretize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_profiles-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Fabrício Almeida-Silva, Tao Zhao, Kristian K Ullrich, Yves Van de Peer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

